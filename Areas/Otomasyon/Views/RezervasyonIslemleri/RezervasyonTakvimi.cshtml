
@{
    ViewBag.Title = "Rezervasyon Takvimi";
    Layout = "~/Areas/Otomasyon/Views/Shared/_Layout.cshtml";
}
@using FotografciTakipWeb.Models

@{
    List<Personel> personellistesi = ViewBag.personeller;
    List<Musteri> musterilistesi = ViewBag.Musteriler;
    List<RezervasyonTurleri> rezervasyonturlerilistesi = ViewBag.RezervasyonTurleri;
    List<CekimPaketleri> paketlistesi = ViewBag.Paketler;
    List<RezervasyonEkHizmet> ekhizmetlistesi = ViewBag.EkHizmetler;
    List<ZamanDilimleri> zamandilimleri = ViewBag.Zamanlar;
    List<Surecler> sureclistesi = ViewBag.Surecler;
    List<SubeToKullanici> SubeKullanici = ViewBag.SubeKullanici;
    KullaniciYetki KullaniciYetki = ViewBag.KullaniciYetki;
    string DetayYetki = KullaniciYetki.KayitDetayi.ToString();
    string DuzenleYetki = KullaniciYetki.KayitDuzenle.ToString();
    string SilYetki = KullaniciYetki.KayitSil.ToString();
    string YazdirYetki = KullaniciYetki.Yazdir.ToString();
    long SubeId = Convert.ToInt64(Session["AktifSubeId"]);
}
@section Head
{
    <link rel="stylesheet" media="screen, print" href="~/Areas/Otomasyon/Content/css/miscellaneous/fullcalendar/fullcalendar.bundle.css">
    <style type="text/css">
        /*<!-- Takvimde pasif olan günler gösterilmesin -->*/
        .fc-other-month .fc-day-number {
            display: none;
        }

        .iptal-randevu {
            text-decoration: line-through;
        }

        .swal2-container {
            display: -webkit-box;
            display: flex;
            position: fixed;
            z-index: 300000; /*Uyarı penceresini herşeyin önüne getimek için*/
        }

        .modal-dialog-full-width {
            width: 102% !important;
            height: 100% !important;
            margin: 0 !important;
            padding: 0 !important;
            max-width: none !important;
        }

        .modal-content-full-width {
            height: auto !important;
            min-height: 100% !important;
            border-radius: 0 !important;
            background-color: #ececec !important;
        }

        .modal-header-full-width {
            border-bottom: 1px solid #9ea2a2 !important;
        }

        .modal-footer-full-width {
            border-top: 1px solid #9ea2a2 !important;
        }
    </style>
}

@*   Yeni Rezervasyon Ekle Modal   *@
<div class="modal fade right" id="YeniRezervasyonEkleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalPreviewLabel" aria-hidden="true">
    <div class="modal-dialog-full-width modal-dialog momodel modal-fluid" role="document">
        <div class="modal-content-full-width modal-content ">
            @*<div class=" modal-header-full-width modal-header text-center">
                    <h5 class="modal-title w-100" id="exampleModalPreviewLabel">Material Design  Full Screen Modal</h5>
                    <button type="button" class="close " data-dismiss="modal" aria-label="Close">
                        <span style="font-size: 1.3em;" aria-hidden="true">&times;</span>
                    </button>
                </div>*@
            <div class="modal-body">
                <button type="button" class="close Vazgec">
                    <span style="font-size: 1.3em;" aria-hidden="true">&times;</span>
                </button>
                <div class="row justify-content-center">
                    <div class="col-lg-10 col-md-10 col-sm-10">
                        <div id="panel-1" class="panel shadow-5">
                            <div class="panel-hdr">
                                <h3> Yeni Rezervasyon Ekle</h3>
                            </div>
                            <div class="panel-container show">
                                <div class="panel-content">
                                    <ul class="nav nav-tabs" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#TabPanel-RezervasyonBilgileri" role="tab" id="Tab-RezervasyonBilgileri" aria-selected="false"><i class="fal fa-calendar-alt mr-1"></i> Rezervasyon Bilgileri</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link disabled" data-toggle="tab" href="#TabPanel-MusteriBilgileri" role="tab" id="Tab-MusteriBilgileri" aria-selected="false"><i class="fal fa-user mr-1"></i> Müşteri Bilgileri</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link disabled" data-toggle="tab" href="#TabPanel-DigerBilgiler" role="tab" id="Tab-DigerBilgiler" aria-selected="false"><i class="fal fa-id-badge mr-1"></i> Diğer Bilgiler</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link disabled" data-toggle="tab" href="#TabPanel-PaketVeEkhizmetler" role="tab" id="Tab-PaketVeEkhizmetler" aria-selected="false"><i class="fal fa-star mr-1"></i> Paket ve Ek Hizmetler</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link disabled" data-toggle="tab" href="#TabPanel-Surecler" role="tab" id="Tab-Surecler" aria-selected="false"><i class="fal fa-clock mr-1"></i> Süreçler</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link disabled" data-toggle="tab" href="#TabPanel-CekimRandevu" role="tab" id="Tab-CekimRandevu" aria-selected="false"><i class="fal fa-camera-alt mr-1"></i>Çekim Randevuları</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link disabled" data-toggle="tab" href="#TabPanel-OdemeBilgileri" role="tab" id="Tab-OdemeBilgileri" aria-selected="false"><i class="fal fa-lira-sign mr-1"></i> Ödeme Bilgileri</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content border border-top-0 p-3">
                                        <div class="tab-pane fade" id="TabPanel-RezervasyonBilgileri" role="tabpanel">
                                            <input type="hidden" id="Yetkili" class="form-control form-control-sm" name="Yetkili" maxlength="50" disabled value="@ViewBag.SubeYetkilisi.Yetkili">
                                            <div class="row">
                                                <div class="col col-md-6">
                                                    <div class="form-group" id="SozlesmeTarihiHata">
                                                        <label class="form-label" for="SozlesmeTarihi">Sözleşme Tarihi</label>
                                                        <div class="input-group">
                                                            <input type="text" class="form-control form-control-sm" value="07/17/2020" id="SozlesmeTarihi">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text fs-sm">
                                                                    <i class="fal fa-calendar-alt"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="form-group" id="RezervasyonTurIdHata">
                                                        <label class="form-label" for="RezervasyonTurId">Rezervasyon Türü</label>
                                                        <select class="custom-select form-control custom-select-sm" id="RezervasyonTurId" name="RezervasyonTurId">
                                                            <option selected="" value="0">Rezervasyon Türünü Seçiniz</option>
                                                            @foreach (var rezervasyonturleri in rezervasyonturlerilistesi)
                                                            {
                                                                <option value="@rezervasyonturleri.Id" data-formalan="@rezervasyonturleri.FormAlan">@rezervasyonturleri.RezervasyonTuru</option>
                                                            }
                                                        </select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="form-label" for="RezervasyonSekliId">Rezervasyon Şekli</label>
                                                        <select class="custom-select form-control custom-select-sm" id="RezervasyonSekliId" name="RezervasyonSekliId">
                                                            <option selected="" value="1">Kesin Rezervasyon</option>
                                                            <option value="2">Opsiyonlu Rezervasyon</option>
                                                            <option value="3">Rezervasyon Teklifi</option>
                                                        </select>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group col-sm-6">
                                                            <label class="form-label" for="RezervasyonTarihi">Rezervasyon Tarihi</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control form-control-sm" value="07/17/2020" id="RezervasyonTarihi" title="İşin yapılacağı tarih">
                                                                <div class="input-group-append">
                                                                    <span class="input-group-text fs-sm">
                                                                        <i class="fal fa-calendar-alt"></i>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="form-group col-sm-6">
                                                            <label class="form-label" for="ZamanDilimiId">Rezervasyon Saati</label>
                                                            <select class="custom-select form-control custom-select-sm" id="ZamanDilimiId" name="ZamanDilimiId" title="İşin saat aralığını seçiniz veya yan taraftan yazınız.">
                                                                <option selected="" value="0">Zaman Aralığı Seçiniz</option>
                                                                @foreach (var zamanlar in zamandilimleri)
                                                                {
                                                                    <option value="@zamanlar.Id">@zamanlar.BaslangicZaman.ToString(@"hh\:mm") - @zamanlar.BitisZaman.ToString(@"hh\:mm")</option>
                                                                }
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group col-sm-6" id="ZamanHata">
                                                            <label class="form-label" for="BaslangicZaman">Başlangıç Saati</label>
                                                            <input class="form-control form-control-sm" id="BaslangicZaman" type="time" name="BaslangicZaman" value="00:00">
                                                        </div>
                                                        <div class="form-group col-sm-6">
                                                            <label class="form-label" for="BitisZaman">Bitiş Saati</label>
                                                            <input class="form-control form-control-sm" id="BitisZaman" type="time" name="BitisZaman" value="00:00">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col col-md-6">
                                                    <div class="form-group">
                                                        <label class="form-label" for="SozlesmeNo">Sözleşme No</label>
                                                        <input type="text" id="SozlesmeNo" class="form-control form-control-sm" name="SozlesmeNo" disabled value="@ViewBag.SozlesmeNo">
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="form-label" for="OrganizasyonYeri">Organizasyon Yeri</label>
                                                        <input type="text" id="OrganizasyonYeri" class="form-control form-control-sm" name="OrganizasyonYeri" maxlength="250">
                                                    </div>
                                                    <div class="form-group" id="OpsiyonTarihiHata">
                                                        <label class="form-label" for="OpsiyonTarihi">Opsiyon Tarihi</label>
                                                        <div class="input-group">
                                                            <input type="text" class="form-control form-control-sm" value="07/17/2020" id="OpsiyonTarihi" disabled title="Opsiyon/Teklif geçerlilik tarihi">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text fs-sm">
                                                                    <i class="fal fa-calendar-alt"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="panel-1" class="panel">
                                                        <div class="card-header py-1" id="sozlesmepersonellisthata">
                                                            <h5 style="padding-top:5px">
                                                                Personeller
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content" id="sozlesmepersonellist">
                                                                <div id="sozlesme_personeller_liste">
                                                                    <div class="input-group mb-g sticky-top bg-faded">
                                                                        <!-- üstte sabitlemek için class a "sticky-top bg-faded" eklendi -->
                                                                        <input type="text" class="form-control form-control form-control-sm shadow-inset-2" id="sozlesme_personeller_liste_arama" placeholder="Personel ara">
                                                                        <div class="input-group-append">
                                                                            <div class="input-group-text">
                                                                                <i class="fal fa-search fs-sm"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <ul class="list-group" id="SozlesmePersonelListesi">
                                                                        @foreach (var personel in personellistesi)
                                                                        {
                                                                            string Sube = "";
                                                                            if (personel.PersonelGorevleri.Gorev == "Şube Yetkilisi")
                                                                            {
                                                                                Sube = " - " + personel.Sube.SubeAdi;
                                                                            }
                                                                            <li class="list-group-item-changed">
                                                                                <div class="custom-control custom-checkbox">
                                                                                    <input type="checkbox" class="custom-control-input" id="@personel.Id" data-persid="@personel.Id">
                                                                                    <label class="custom-control-label" data-filter-tags="@personel.AdiSoyadi.ToLower()" for="@personel.Id">@personel.AdiSoyadi - @personel.PersonelGorevleri.Gorev @Sube</label>
                                                                                </div>
                                                                            </li>
                                                                        }
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-content d-flex py-2 rounded-bottom border-faded border-left-0 border-right-0 border-bottom-0 text-muted">
                                                <div class="form-check-inline ml-auto">
                                                    <button type="button" class="btn btn-secondary btn-md btn-rounded mr-2 Kapat" id="RezervasyonBilgileriKapat">Kapat <i class="fal fa-window-close"></i></button>
                                                    <button type="button" class="btn btn-danger btn-md btn-rounded mr-2 Vazgec" id="RezervasyonBilgileriVazgec">Vazgeç <i class="fal fa-times-circle"></i></button>
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="RezervasyonBilgileriDevam">
                                                        Devam
                                                        <i class="fal fa-arrow-alt-right ml-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="TabPanel-MusteriBilgileri" role="tabpanel">
                                            <div class="row">
                                                <div class="form-group col-sm-6">
                                                    <label class="form-label" for="MusteriId">Müşteri</label>
                                                    <select class="custom-select form-control custom-select-sm" id="MusteriId" name="MusteriId" title="Kayıtlı müşterilerden seçebilirsiniz.">
                                                        <option selected="" data-musterikodu="@ViewBag.Musterikodu" value="0">Müşteri Seçiniz - Yeni Müşteri</option>
                                                        @foreach (var musteriler in musterilistesi)
                                                        {
                                                            <option value="@musteriler.Id" data-musterikodu="@musteriler.MusteriKodu" data-adsoyad="@musteriler.AdiSoyadi"
                                                                    data-tckimlikno="@musteriler.TCKimlikNo" data-email="@musteriler.Email" data-ceptel="@musteriler.CepTel"
                                                                    data-sabittel="@musteriler.SabitTel" data-adres="@musteriler.Adres" data-notlar="@musteriler.Notlar">
                                                                @musteriler.AdiSoyadi - (@musteriler.Sube.SubeAdi)
                                                            </option>
                                                        }
                                                    </select>
                                                </div>
                                                <div class="form-group col-sm-6">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-sm-6">
                                                    <label class="form-label" for="MusteriKodu">Müşteri Kodu</label>
                                                    <input type="text" id="MusteriKodu" class="form-control form-control-sm" name="MusteriKodu" disabled placeholder="Otomatik Oluşturulacak." value="@ViewBag.Musterikodu">
                                                </div>
                                                <div class="form-group col-sm-6" id="AdSoyadHata">
                                                    <label class="form-label" for="AdSoyad">Ad Soyad</label>
                                                    <input type="text" id="AdSoyad" class="form-control form-control-sm" name="AdSoyad" maxlength="50" required>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-sm-6">
                                                    <label class="form-label" for="TCKimlikNo">TC Kimlik No</label>
                                                    <input type="text" id="TCKimlikNo" class="form-control form-control-sm" name="TCKimlikNo" maxlength="11" data-inputmask="'mask': '99999999999'">
                                                </div>
                                                <div class="form-group col-sm-6">
                                                    <label class="form-label">Email Adresi</label>
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text"><i class="fal fa-mouse-pointer width-1 text-align-center"></i></span>
                                                        </div>
                                                        <input type="text" data-inputmask="'alias': 'email'" class="form-control form-control-sm" im-insert="true" name="Email" id="Email" maxlength="50">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-sm-6" id="CepTelHata">
                                                    <label class="form-label">Cep Telefonu</label>
                                                    <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="CepTel" id="CepTel" required>
                                                </div>
                                                <div class="form-group col-sm-6">
                                                    <label class="form-label">Sabit Telefon</label>
                                                    <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="SabitTel" id="SabitTel">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-sm-6">
                                                    <label class="form-label" for="Adres">Adres</label>
                                                    <textarea class="form-control form-control-sm" id="Adres" rows="2" name="Adres" style="overflow:auto;resize:none"></textarea>
                                                </div>
                                                <div class="form-group col-sm-6">
                                                    <label class="form-label" for="Notlar">Notlar</label>
                                                    <textarea class="form-control form-control-sm" id="Notlar" rows="2" name="Notlar" style="overflow:auto;resize:none"></textarea>
                                                </div>
                                            </div>
                                            <div class="panel-content d-flex py-2 rounded-bottom border-faded border-left-0 border-right-0 border-bottom-0 text-muted">
                                                <div class="form-check-inline">
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="MusteriBilgileriGeri">
                                                        <i class="fal fa-arrow-alt-left ml-1"></i>
                                                        Geri
                                                    </button>
                                                </div>
                                                <div class="form-check-inline ml-auto">
                                                    <button type="button" class="btn btn-secondary btn-md btn-rounded mr-2 Kapat" id="MusteriBilgileriKapat">Kapat <i class="fal fa-window-close"></i></button>
                                                    <button type="button" class="btn btn-danger btn-md btn-rounded mr-2 Vazgec" id="MusteriBilgileriVazgec">Vazgeç <i class="fal fa-times-circle"></i></button>
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="MusteriBilgileriDevam">
                                                        Devam
                                                        <i class="fal fa-arrow-alt-right ml-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="TabPanel-DigerBilgiler" role="tabpanel">
                                            <div class="card m-auto border Gelin">
                                                <div class="card-header py-2">
                                                    <div class="card-title">
                                                        Gelin
                                                    </div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="row">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="GelinAdSoyad">Ad Soyad</label>
                                                            <input type="text" id="GelinAdSoyad" class="form-control form-control-sm" name="GelinAdSoyad" maxlength="50">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="GelinCep">Cep Telefonu</label>
                                                            <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="GelinCep" id="GelinCep">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label">Email Adresi</label>
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text"><i class="fal fa-mouse-pointer width-1 text-align-center"></i></span>
                                                                </div>
                                                                <input type="text" data-inputmask="'alias': 'email'" class="form-control form-control-sm" im-insert="true" name="GelinEmail" id="GelinEmail" maxlength="50">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-3 Gelin"></div>
                                            <div class="card m-auto border Damat">
                                                <div class="card-header py-2">
                                                    <div class="card-title">
                                                        Damat
                                                    </div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="row" style="margin-bottom:-15px">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="DamatAdSoyad">Ad Soyad</label>
                                                            <input type="text" id="DamatAdSoyad" class="form-control form-control-sm" name="DamatAdSoyad" maxlength="50">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="DamatCep">Cep Telefonu</label>
                                                            <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="DamatCep" id="DamatCep">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label">Email Adresi</label>
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text"><i class="fal fa-mouse-pointer width-1 text-align-center"></i></span>
                                                                </div>
                                                                <input type="text" data-inputmask="'alias': 'email'" class="form-control form-control-sm" im-insert="true" name="DamatEmail" id="DamatEmail" maxlength="50">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-3 Damat"></div>
                                            <div class="card m-auto border BebekCocuk">
                                                <div class="card-header py-2">
                                                    <div class="card-title">
                                                        Bebek/Çocuk
                                                    </div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="row">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="BebekAdSoyad">Bebek/Çocuk Ad Soyad</label>
                                                            <input type="text" id="BebekAdSoyad" class="form-control form-control-sm" name="BebekAdSoyad" maxlength="50">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="BabaAdSoyad">Baba Ad Soyad</label>
                                                            <input type="text" id="BabaAdSoyad" class="form-control form-control-sm" name="BabaAdSoyad" maxlength="50">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="AnneAdSoyad">Anne Ad Soyad</label>
                                                            <input type="text" id="AnneAdSoyad" class="form-control form-control-sm" name="AnneAdSoyad" maxlength="50">
                                                        </div>
                                                    </div>
                                                    <div class="row" style="margin-bottom:-15px">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="BabaCep">Baba Cep Telefonu</label>
                                                            <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="BabaCep" id="BabaCep">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="AnneCep">Anne Cep Telefonu</label>
                                                            <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="AnneCep" id="AnneCep">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label">Email Adresi</label>
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text"><i class="fal fa-mouse-pointer width-1 text-align-center"></i></span>
                                                                </div>
                                                                <input type="text" data-inputmask="'alias': 'email'" class="form-control form-control-sm" im-insert="true" name="BabaEmail" id="BabaEmail" maxlength="50">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-3 BebekCocuk"></div>
                                            <div class="card m-auto border UrunKatalog">
                                                <div class="card-header py-2">
                                                    <div class="card-title">
                                                        Ürün/Katalog
                                                    </div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="row mb-3">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="Urunler">Ürünler</label>
                                                            <textarea class="form-control form-control-sm" id="Urunler" rows="4" name="Urunler" style="overflow:auto;resize:none"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-0">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="UrunYetkiliAdSoyad">Yetkili/Sorumlu Ad Soyad</label>
                                                            <input type="text" id="UrunYetkiliAdSoyad" class="form-control form-control-sm" name="UrunYetkiliAdSoyad" maxlength="50">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="UrunYetkiliCep">Cep Telefonu</label>
                                                            <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="UrunYetkiliCep" id="UrunYetkiliCep">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label">Email Adresi</label>
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text"><i class="fal fa-mouse-pointer width-1 text-align-center"></i></span>
                                                                </div>
                                                                <input type="text" data-inputmask="'alias': 'email'" class="form-control form-control-sm" im-insert="true" name="UrunYetkiliEmail" id="UrunYetkiliEmail" maxlength="50">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-3 UrunKatalog"></div>
                                            <div class="card m-auto border ModelManken">
                                                <div class="card-header py-2">
                                                    <div class="card-title">
                                                        Model/Manken
                                                    </div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="row mb-3">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="Modeller">Model/Manken İsimleri</label>
                                                            <textarea class="form-control form-control-sm" id="Modeller" rows="4" name="Modeller" style="overflow:auto;resize:none"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-0">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="ModelYetkiliAdSoyad">Yetkili/Sorumlu Ad Soyad</label>
                                                            <input type="text" id="ModelYetkiliAdSoyad" class="form-control form-control-sm" name="ModelYetkiliAdSoyad" maxlength="50">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="ModelYetkiliCep">Cep Telefonu</label>
                                                            <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="ModelYetkiliCep" id="ModelYetkiliCep">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label">Email Adresi</label>
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text"><i class="fal fa-mouse-pointer width-1 text-align-center"></i></span>
                                                                </div>
                                                                <input type="text" data-inputmask="'alias': 'email'" class="form-control form-control-sm" im-insert="true" name="ModelYetkiliEmail" id="ModelYetkiliEmail" maxlength="50">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-3 ModelManken"></div>
                                            <div class="card m-auto border Yetkili">
                                                <div class="card-header py-2">
                                                    <div class="card-title">
                                                        Yetkili
                                                    </div>
                                                </div>
                                                <div class="card-body">
                                                    <div class="row" style="margin-bottom:-15px">
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="YetkiliAdSoyad">Yetkili/Sorumlu Ad Soyad</label>
                                                            <input type="text" id="YetkiliAdSoyad" class="form-control form-control-sm" name="YetkiliAdSoyad" maxlength="50">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label" for="YetkiliCep">Cep Telefonu</label>
                                                            <input type="text" data-inputmask="'mask': '(0999) 999-9999'" class="form-control form-control-sm" im-insert="true" name="YetkiliCep" id="YetkiliCep">
                                                        </div>
                                                        <div class="form-group col-sm-4">
                                                            <label class="form-label">Email Adresi</label>
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text"><i class="fal fa-mouse-pointer width-1 text-align-center"></i></span>
                                                                </div>
                                                                <input type="text" data-inputmask="'alias': 'email'" class="form-control form-control-sm" im-insert="true" name="YetkiliEmail" id="YetkiliEmail" maxlength="50">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-3 Yetkili"></div>
                                            <div class="panel-content d-flex py-2 rounded-bottom border-faded border-left-0 border-right-0 border-bottom-0 text-muted">
                                                <div class="form-check-inline">
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="DigerBilgilerGeri">
                                                        <i class="fal fa-arrow-alt-left ml-1"></i>
                                                        Geri
                                                    </button>
                                                </div>
                                                <div class="form-check-inline ml-auto">
                                                    <button type="button" class="btn btn-secondary btn-md btn-rounded mr-2 Kapat" id="DigerBilgileriKapat">Kapat <i class="fal fa-window-close"></i></button>
                                                    <button type="button" class="btn btn-danger btn-md btn-rounded mr-2 Vazgec" id="DigerBilgileriVazgec">Vazgeç <i class="fal fa-times-circle"></i></button>
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="DigerBilgilerDevam">
                                                        Devam
                                                        <i class="fal fa-arrow-alt-right ml-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="TabPanel-PaketVeEkhizmetler" role="tabpanel">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div id="panel-1" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Paketler
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content" id="slimtest1">
                                                                <div id="paketler_liste">
                                                                    <div class="input-group mb-g sticky-top bg-faded">
                                                                        <!-- üstte sabitlemek için class a "sticky-top bg-faded" eklendi -->
                                                                        <input type="text" class="form-control form-control form-control-sm shadow-inset-2" id="paketler_liste_arama" placeholder="Paket ara">
                                                                        <div class="input-group-append">
                                                                            <div class="input-group-text">
                                                                                <i class="fal fa-search fs-sm"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <ul class="list-group" id="Paketler">
                                                                        <!--  Paketler burada listelenecek  -->
                                                                        @foreach (var paketler in paketlistesi)
                                                                        {
                                                                            <li class="list-group-item-changed">
                                                                                <div class="custom-control custom-checkbox">
                                                                                    <input type="checkbox" class="custom-control-input form-control-sm" data-filter-tags="@paketler.PaketAdi.ToLower()" id="@paketler.Id@paketler.PaketAdi" data-paketid="@paketler.Id" data-fiyat="@paketler.Fiyat" data-paketdetay="@paketler.PaketDetayi" value="@paketler.PaketAdi">
                                                                                    <label class="custom-control-label" data-filter-tags="@paketler.PaketAdi.ToLower()" for="@paketler.Id@paketler.PaketAdi">@paketler.PaketAdi - <b> @String.Format("{0:C}", paketler.Fiyat).Replace("₺", "") TL</b></label>
                                                                                </div>
                                                                            </li>
                                                                        }
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div id="panel-2" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Paket Detayları
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content" id="slimtest2">
                                                                <!-- Seçilen paketlerin içeriği ve fiyatı buraya eklenecek  -->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div id="panel-1" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Ek Hizmetler
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content" id="slimtest3">
                                                                <div id="hizmetler_liste">
                                                                    <div class="input-group mb-g sticky-top bg-faded">
                                                                        <!-- üstte sabitlemek için class a "sticky-top bg-faded" eklendi -->
                                                                        <input type="text" class="form-control form-control form-control-sm shadow-inset-2" id="hizmetler_liste_arama" placeholder="Ek hizmet ara">
                                                                        <div class="input-group-append">
                                                                            <div class="input-group-text">
                                                                                <i class="fal fa-search fs-sm"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <ul class="list-group" id="EkHizmetler">
                                                                        <!--  Paketler burada listelenecek  -->
                                                                        @foreach (var ekhizmetler in ekhizmetlistesi)
                                                                        {
                                                                            <li class="list-group-item-changed">
                                                                                <div class="custom-control custom-checkbox">
                                                                                    <input type="checkbox" class="custom-control-input" id="@ekhizmetler.Id@ekhizmetler.EkHizmetAdi" data-filter-tags="@ekhizmetler.EkHizmetAdi.ToLower()" data-ekhizmetid="@ekhizmetler.Id" data-fiyat="@ekhizmetler.Fiyat" data-ekhizmetdetay="@ekhizmetler.Aciklama" value="@ekhizmetler.EkHizmetAdi">
                                                                                    <label class="custom-control-label" data-filter-tags="@ekhizmetler.EkHizmetAdi.ToLower()" for="@ekhizmetler.Id@ekhizmetler.EkHizmetAdi">@ekhizmetler.EkHizmetAdi - <b>@String.Format("{0:C}", ekhizmetler.Fiyat).Replace("₺", "") TL</b></label>
                                                                                </div>
                                                                            </li>
                                                                        }
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div id="panel-2" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Ek Hizmet Detayları
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content" id="slimtest4">
                                                                <!-- Seçilen paketlerin içeriği ve fiyatı buraya eklenecek  -->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div id="panel-2" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Ücretlendirme
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content">
                                                                <div class="row">
                                                                    <div class="form-group col-sm-3">
                                                                        <label class="form-label " for="PaketTutar">Paketler Tutarı </label>
                                                                        <input type="text" placeholder="0.00" data-inputmask="'alias': 'currency'" class="form-control form-control-sm tutarlar" name="PaketTutar" maxlength="50" id="PaketTutar" disabled>
                                                                    </div>
                                                                    <div class="form-group col-sm-3">
                                                                        <label class="form-label" for="EkHizmetTutar">Ek Hizmetler Tutarı </label>
                                                                        <input type="text" placeholder="0.00" data-inputmask="'alias': 'currency'" class="form-control form-control-sm tutarlar" name="EkHizmetTutar" maxlength="50" id="EkHizmetTutar" disabled>
                                                                    </div>
                                                                    <div class="form-group col-sm-3">
                                                                        <label class="form-label" for="Iskonto">İskonto </label>
                                                                        <input type="text" placeholder="0.00" data-inputmask="'alias': 'currency'" class="form-control form-control-sm tutarlar" name="Iskonto" maxlength="50" id="Iskonto">
                                                                    </div>
                                                                    <div class="form-group col-sm-3">
                                                                        <label class="form-label" for="ToplamTutar">Toplam Tutar </label>
                                                                        <input type="text" placeholder="0.00" data-inputmask="'alias': 'currency'" class="form-control form-control-sm" name="ToplamTutar" maxlength="50" id="ToplamTutar">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-content d-flex py-2 rounded-bottom border-faded border-left-0 border-right-0 border-bottom-0 text-muted">
                                                <div class="form-check-inline">
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="PaketlerGeri">
                                                        <i class="fal fa-arrow-alt-left ml-1"></i>
                                                        Geri
                                                    </button>
                                                </div>
                                                <div class="form-check-inline ml-auto">
                                                    <button type="button" class="btn btn-secondary btn-md btn-rounded mr-2 Kapat" id="PaketlerKapat">Kapat <i class="fal fa-window-close"></i></button>
                                                    <button type="button" class="btn btn-danger btn-md btn-rounded mr-2 Vazgec" id="PaketlerVazgec">Vazgeç <i class="fal fa-times-circle"></i></button>
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="PaketlerDevam">
                                                        Devam
                                                        <i class="fal fa-arrow-alt-right ml-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="TabPanel-Surecler" role="tabpanel">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div id="panel-1" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Süreçler
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content" id="slimtest5">
                                                                <div id="surecler_liste">
                                                                    <div class="input-group mb-g sticky-top bg-faded">
                                                                        <!-- üstte sabitlemek için class a "sticky-top bg-faded" eklendi -->
                                                                        <input type="text" class="form-control form-control form-control-sm shadow-inset-2" id="surecler_liste_arama" placeholder="Süreç ara">
                                                                        <div class="input-group-append">
                                                                            <div class="input-group-text">
                                                                                <i class="fal fa-search fs-sm"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <ul class="list-group" id="Surecler">
                                                                        <!--  Paketler burada listelenecek  -->
                                                                        @foreach (var surecler in sureclistesi.OrderByDescending(x => x.KilitBit))
                                                                        {
                                                                            <li class="list-group-item-changed">
                                                                                <div class="custom-control custom-checkbox">
                                                                                    @if (surecler.SurecAdi == "Sözleşme Yapıldı")
                                                                                    {
                                                                                        <input type="checkbox" checked disabled class="custom-control-input" id="@surecler.Id" data-surecid="@surecler.Id">
                                                                                        <label class="custom-control-label" data-filter-tags="@surecler.SurecAdi.ToLower()" for="@surecler.Id">@surecler.SurecAdi</label>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <input type="checkbox" class="custom-control-input" id="@surecler.Id" data-surecid="@surecler.Id">
                                                                                        <label class="custom-control-label" data-filter-tags="@surecler.SurecAdi.ToLower()" for="@surecler.Id">@surecler.SurecAdi</label>
                                                                                    }
                                                                                </div>
                                                                            </li>
                                                                        }
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-content d-flex py-2 rounded-bottom border-faded border-left-0 border-right-0 border-bottom-0 text-muted">
                                                <div class="form-check-inline">
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="SureclerGeri">
                                                        <i class="fal fa-arrow-alt-left ml-1"></i>
                                                        Geri
                                                    </button>
                                                </div>
                                                <div class="form-check-inline ml-auto">
                                                    <button type="button" class="btn btn-secondary btn-md btn-rounded mr-2 Kapat" id="SureclerKapat">Kapat <i class="fal fa-window-close"></i></button>
                                                    <button type="button" class="btn btn-danger btn-md btn-rounded mr-2 Vazgec" id="SureclerVazgec">Vazgeç <i class="fal fa-times-circle"></i></button>
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="SureclerDevam">
                                                        Devam
                                                        <i class="fal fa-arrow-alt-right ml-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="TabPanel-CekimRandevu" role="tabpanel">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div id="panel-1" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Çekim Randevuları
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content">
                                                                <div class="alert alert-secondary" role="alert">
                                                                    <strong>Uyarı!</strong> <br />Rezervasyon tarihi haricinde ek olarak yapılacak çekimleri ekleyiniz.
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-6">
                                                                        <div class="row">
                                                                            <div class="form-group col-sm-12">
                                                                                <label class="form-label" for="CekimTarihi">Tarih</label>
                                                                                <div class="input-group">
                                                                                    <input type="text" class="form-control form-control-sm" value="07/17/2020" id="CekimTarihi">
                                                                                    <div class="input-group-append">
                                                                                        <span class="input-group-text fs-sm">
                                                                                            <i class="fal fa-calendar-alt"></i>
                                                                                        </span>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="form-group col-sm-6" id="CekimZamanHata">
                                                                                <label class="form-label" for="CekimBaslangic">Başlangıç Saati</label>
                                                                                <input class="form-control form-control-sm" id="CekimBaslangic" type="time" name="CekimBaslangic" value="00:00">
                                                                            </div>
                                                                            <div class="form-group col-sm-6">
                                                                                <label class="form-label" for="CekimBitis">Bitiş Saati</label>
                                                                                <input class="form-control form-control-sm" id="CekimBitis" type="time" name="CekimBitis" value="00:00">
                                                                            </div>
                                                                            <div class="form-group col-sm-12" id="CekimYeriHata">
                                                                                <label class="form-label" for="CekimYeri">Çekim Yeri</label>
                                                                                <input type="text" id="CekimYeri" class="form-control form-control-sm" name="CekimYeri" maxlength="50">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-6">
                                                                        <div id="panel-1" class="panel">
                                                                            <div class="card-header py-1" id="CekimPersonelIdHata">
                                                                                <h5 style="padding-top:5px">
                                                                                    Personeller
                                                                                </h5>
                                                                            </div>
                                                                            <div class="panel-container show">
                                                                                <div class="panel-content" id="personellist">
                                                                                    <div id="personeller_liste">
                                                                                        <div class="input-group mb-g sticky-top bg-faded">
                                                                                            <!-- üstte sabitlemek için class a "sticky-top bg-faded" eklendi -->
                                                                                            <input type="text" class="form-control form-control form-control-sm shadow-inset-2" id="personeller_liste_arama" placeholder="Personel ara">
                                                                                            <div class="input-group-append">
                                                                                                <div class="input-group-text">
                                                                                                    <i class="fal fa-search fs-sm"></i>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <ul class="list-group" id="PersonelListesi">
                                                                                            @foreach (var personel in personellistesi)
                                                                                            {
                                                                                                <li class="list-group-item-changed">
                                                                                                    <div class="custom-control custom-checkbox">
                                                                                                        <input type="checkbox" class="custom-control-input" id="cekim-@personel.Id" data-spersid="cekim-@personel.Id">
                                                                                                        <label class="custom-control-label" data-filter-tags="@personel.AdiSoyadi.ToLower()" for="cekim-@personel.Id">@personel.AdiSoyadi - @personel.PersonelGorevleri.Gorev</label>
                                                                                                    </div>
                                                                                                </li>
                                                                                            }
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-sm-4" style="margin: auto auto;">
                                                                        <button type="button" class="btn btn-sm btn-primary btn-block waves-effect waves-themed" id="CekimEkle">
                                                                            Randevu Ekle
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="panel-content">
                                                                <table class="table table-bordered table-sm table-responsive-sm table-hover m-0 mb-2" id="tb-cekimrandeulari">
                                                                    <thead class="thead-themed">
                                                                        <tr>
                                                                            <th>Tarih</th>
                                                                            <th>Zaman</th>
                                                                            <th>Açıklama</th>
                                                                            <th>Personel</th>
                                                                            <th class="w-10">İşlem</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="cekimrandevu-satir">
                                                                        <tr>
                                                                            <td></td>
                                                                            <td></td>
                                                                            <td></td>
                                                                            <td></td>
                                                                            <td></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                <div class="col col-3 col-lg-3 bg-danger-50"> İptal Randevu Görünümü</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-content d-flex py-2 rounded-bottom border-faded border-left-0 border-right-0 border-bottom-0 text-muted">
                                                <div class="form-check-inline">
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="CekimRandevuGeri">
                                                        <i class="fal fa-arrow-alt-left ml-1"></i>
                                                        Geri
                                                    </button>
                                                </div>
                                                <div class="form-check-inline ml-auto">
                                                    <button type="button" class="btn btn-secondary btn-md btn-rounded mr-2 Kapat" id="CekimRandevuKapat">Kapat <i class="fal fa-window-close"></i></button>
                                                    <button type="button" class="btn btn-danger btn-md btn-rounded mr-2 Vazgec" id="CekimRandevuVazgec">Vazgeç <i class="fal fa-times-circle"></i></button>
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="CekimRandevuDevam">
                                                        Devam
                                                        <i class="fal fa-arrow-alt-right ml-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="TabPanel-OdemeBilgileri" role="tabpanel">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div id="panel-1" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Alınan Ödemeler
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content">
                                                                <div class="row">
                                                                    <div class="form-group col-sm-4">
                                                                        <label class="form-label" for="OdemeTarihi">Tarih</label>
                                                                        <div class="input-group">
                                                                            <input type="text" class="form-control form-control-sm" value="07/17/2020" id="OdemeTarihi">
                                                                            <div class="input-group-append">
                                                                                <span class="input-group-text fs-sm">
                                                                                    <i class="fal fa-calendar-alt"></i>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-sm-4" id="OdemeTutarHata">
                                                                        <label class="form-label" for="OdemeTutar">Tutar</label>
                                                                        <input type="text" placeholder="0.00" data-inputmask="'alias': 'currency'" class="form-control form-control-sm" name="OdemeTutar" maxlength="50" id="OdemeTutar">
                                                                        <input type="text" placeholder="0.00" data-inputmask="'alias': 'currency'" class="form-control form-control-sm" name="OdemeTutar" maxlength="50" id="SilinenTutar" style="display:none">
                                                                    </div>
                                                                    <div class="form-group col-sm-4">
                                                                        <label class="form-label" for="OdemeSekli">Ödeme Şekli</label>
                                                                        <select class="custom-select form-control custom-select-sm" id="OdemeSekli" name="OdemeSekli" title="Ödeme Şeklini Seçiniz.">
                                                                            <option selected="" value="1">Nakit</option>
                                                                            <option value="2">Kredi Kartı</option>
                                                                            <option value="3">Banka Havalesi</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="form-group col-sm-9">
                                                                        <label class="form-label" for="OdemeAciklama">Açıklama</label>
                                                                        <input type="text" id="OdemeAciklama" class="form-control form-control-sm" name="OdemeAciklama" maxlength="50">
                                                                    </div>
                                                                    <div class="form-group col-sm-3" style="margin: auto auto;">
                                                                        <button type="button" class="btn btn-sm btn-outline-primary waves-effect waves-themed" id="OdemeAl">
                                                                            Ekle
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="panel-content">
                                                                <table class="table table-bordered table-sm table-responsive-sm table-hover m-0 mb-2" id="tb-alinanodemeler">
                                                                    <thead class="thead-themed">
                                                                        <tr>
                                                                            @*<th class="text-center">#</th>*@
                                                                            <th class="text-center">Tarih</th>
                                                                            <th class="text-center">Tutar</th>
                                                                            <th class="text-center">Açıklama</th>
                                                                            <th class="text-center">İşlem</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="alinanodemeler-satir">
                                                                        <tr>
                                                                            <td class="text-right fw-700"></td>
                                                                            <td class="text-right fw-700"></td>
                                                                            <td class="text-right fw-700"></td>
                                                                            <td class="text-right fw-700"></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                <div class="alert alert-primary" role="alert">
                                                                    <table class="table table-sm table-responsive-sm m-0">
                                                                        <tbody>
                                                                            <tr>
                                                                                <td class="text-right w-75 fw-700">Sözleşme Tutarı:</td>
                                                                                <td class="text-right w-25 fw-700" id="sozlesmetutari">0,00 TL</td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td class="text-right w-75 fw-700">Toplam Ödeme:</td>
                                                                                <td class="text-right w-25 fw-700" id="Odemetoplam">0,00 TL</td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td class="text-right w-75 fw-700">Kalan Ödemeler Toplamı:</td>
                                                                                <td class="text-right w-25 fw-700" id="kalanodemetoplam">0,00 TL</td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td class="text-right w-75 fw-700">Kalan:</td>
                                                                                <td class="text-right w-25 fw-700" id="sozlesmekalan">0,00 TL</td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                                <div class="col col-5 col-lg-5 bg-danger-50"> İptal Ödeme Görünümü</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div id="panel-1" class="panel">
                                                        <div class="card-header py-1">
                                                            <h5 style="padding-top:5px">
                                                                Kalan Ödemler / Taksitler
                                                            </h5>
                                                        </div>
                                                        <div class="panel-container show">
                                                            <div class="panel-content">
                                                                <div class="row">
                                                                    <div class="form-group col-sm-4">
                                                                        <label class="form-label" for="KalanOdemeTarihi">Ödeme Tarihi</label>
                                                                        <div class="input-group">
                                                                            <input type="text" class="form-control form-control-sm" value="07/17/2020" id="KalanOdemeTarihi">
                                                                            <div class="input-group-append">
                                                                                <span class="input-group-text fs-sm">
                                                                                    <i class="fal fa-calendar-alt"></i>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-sm-3" id="KalanTutarHata">
                                                                        <label class="form-label" for="KalanOdemeTutar">Tutar</label>
                                                                        <input type="text" placeholder="0.00" data-inputmask="'alias': 'currency'" class="form-control form-control-sm" name="KalanOdemeTutar" maxlength="50" id="KalanOdemeTutar">
                                                                    </div>
                                                                    <div class="form-group col-sm-3">
                                                                        <label class="form-label" for="KalanOdemeAciklama">Açıklama</label>
                                                                        <input type="text" id="KalanOdemeAciklama" class="form-control form-control-sm" name="KalanOdemeAciklama" maxlength="50">
                                                                    </div>
                                                                    <div class="form-group col-sm-2" style="margin: auto auto;">
                                                                        <button type="button" class="btn btn-sm btn-outline-primary waves-effect waves-themed" id="AlacakEkle">
                                                                            Ekle
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="panel-content">
                                                                <table class="table table-bordered table-sm table-responsive-sm table-hover m-0 mb-2" id="tb-gelecekodemeler">
                                                                    <thead class="thead-themed">
                                                                        <tr>
                                                                            @*<th class="text-center">#</th>*@
                                                                            <th class="text-center">Ödeme Tarihi</th>
                                                                            <th class="text-center">Tutar</th>
                                                                            <th class="text-center">Açıklama</th>
                                                                            <th class="text-center">İşlem</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="gelecekodemeler-satir">
                                                                        <tr>
                                                                            @*<th scope="row">1</th>*@
                                                                            <td class="text-center"></td>
                                                                            <td class="text-right"></td>
                                                                            <td class="text-center"></td>
                                                                            <td class="text-center"></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                <div class="alert alert-primary" role="alert">
                                                                    <table class="table table-sm table-responsive-sm m-0">
                                                                        <tbody>
                                                                            <tr>
                                                                                <td class="text-right w-75 fw-700">Kalan Ödemeler Toplamı:</td>
                                                                                <td class="text-right w-25 fw-700" id="kalanodemetoplam2">0,00 TL</td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                                <div class="col col-5 col-lg-5 bg-primary-50"> Alinan Ödeme Görünümü</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-content d-flex py-2 rounded-bottom border-faded border-left-0 border-right-0 border-bottom-0 text-muted">
                                                <div class="form-check-inline">
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="OdemelerGeri">
                                                        <i class="fal fa-arrow-alt-left ml-1"></i>
                                                        Geri
                                                    </button>
                                                </div>
                                                <div class="form-check-inline ml-auto">
                                                    <button type="button" class="btn btn-secondary btn-md btn-rounded mr-2 Kapat" id="OdemelerKapat">Kapat <i class="fal fa-window-close"></i></button>
                                                    <button type="button" class="btn btn-danger btn-md btn-rounded mr-2 Vazgec" id="OdemelerVazgec">Vazgeç <i class="fal fa-times-circle"></i></button>
                                                    <button type="button" class="btn btn-primary waves-effect waves-themed" id="OdemelerSozlesmeGoruntule">
                                                        Bitir ve Sözleşmeyi Görüntüle
                                                        <i class="fal fa-file-alt ml-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@*   Yeni Rezervasyon Ekle Modal   *@

<div class="col-xl-12">
    <div id="panel-1" class="panel">
        @if (KullaniciYetki.KayitEkle)
        {
            <div class="panel-hdr">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#YeniRezervasyonEkleModal" style="margin:10px 10px 10px 17px " id="YeniEkle"> Yeni Rezervasyon Ekle </button>
            </div>
        }

        <div class="panel-container show">
            <div class="panel-content">
                <div id="takvim"></div>

                <!-- Modal : TODO -->
                <!-- Modal end -->
            </div>
        </div>
    </div>
</div>

@section Script
{
    <script src="~/Areas/Otomasyon/Content/js/dependency/moment/moment.js"></script>
    <script src="~/Areas/Otomasyon/Content/js/miscellaneous/fullcalendar/fullcalendar.bundle.js"></script>
    <script>
        function timeFormat(t) {
            var saat = t.getHours();
            if (saat < 4) {
                saat = saat + 21
            }
            else {
                saat = saat - 3;
            }
            if (saat < 10) {
                saat = "0" + saat;
            }
            var dakika = t.getMinutes();
            if (dakika < 10) {
                dakika = "0" + dakika;
            }
            var zaman = saat + ":" + dakika
            return zaman;
        }
        function timeFormatTakvim(t) {
            var saat = t.getHours();
            if (saat < 4) {
                saat = saat + 21
            }
            else {
                saat = saat - 3;
            }
            if (saat < 10) {
                saat = "0" + saat;
            }
            var dakika = t.getMinutes();
            if (dakika < 10) {
                dakika = "0" + dakika;
            }
            var zaman = saat + ":" + dakika
            return zaman;
        }
        document.addEventListener('DOMContentLoaded', function () {

            var olaylar = [];
            var calendarEl = document.getElementById('takvim');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                plugins: ['bootstrap', 'dayGrid', 'timeGrid', 'list', 'interaction'],
                themeSystem: 'bootstrap',
                timeZone: 'UTC',
                columnHeaderFormat: { weekday: 'long' },
                locale: 'tr',
                height: 'auto',
                firstDay: 1,
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay'
                    //right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
                },
                buttonText: {
                    today: 'Bugün',
                    month: 'Ay',
                    week: 'Hafta',
                    day: 'Gün',
                    list: 'Liste',
                    listMonth: 'Aylık Liste',
                    listYear: 'Yıllık Liste',
                    listWeek: 'Haftalık Liste',
                    listDay: 'Günlük Liste'
                },
                allDayText: "Tüm Gün",
                eventLimitText: 'Randevu',
                eventTimeFormat:
                {
                    hour: 'numeric',
                    minute: '2-digit',
                    meridiem: 'short'
                },
                dateClick: function (info) {
                    // Ayarlardaki durumu göre değişecek
                    //var id = info.dateStr;
                    //id = id.replace(":", "-");
                    //id = id.replace(":", "-");
                    //id = id.replace("Z", "");
                    //window.location.replace("/Otomasyon/RezervasyonIslemleri/YeniRezervasyonEkleTakvim/" + id);

                },
                eventClick: function (info) {
                    //alert('Event: ' + info.event.title);
                    //alert('Id: ' + info.event.id);
                    //alert('Coordinates: ' + info.jsEvent.pageX + ',' + info.jsEvent.pageY);
                    //alert('View: ' + info.view.type);

                    // Randevu düzenleme sayfasına yönlendirilecek
                    // Randevu detay sayfasına yönlendirilecek yada popup açılacak
                },
                //defaultDate: '2019-08-12',
                navLinks: true, // can click day/week names to navigate views
                editable: false,
                eventLimit: true, // allow "more" link when too many events
                //events: function (fetchInfo, successCallback, failureCallback) { bu şekilde çalıştı
                events: function (info, successCallback, failureCallback) {
                    $.ajax({
                        url: '/Otomasyon/RezervasyonIslemleri/TakvimRandevular/',
                        type: "GET",
                        contentType: "application/json; charset=utf-8",
                        dataType: "JSON",
                        success: function (data) {
                            $.each(data, function (i, item) {
                                $.each(item, function (j, item_1) {
                                    var starih = moment(item_1.BaslangicTarih).format('YYYY-MM-DD');
                                    var etarih = moment(item_1.BitisTarih).format('YYYY-MM-DD');
                                    var ssaat = item_1.BaslangicSaat;
                                    var esaat = item_1.BitisSaat;
                                    olaylar.push(
                                        {
                                            title: item_1.Baslik,
                                            description: item_1.Aciklama,
                                            id: item_1.Id,
                                            //start: moment(item_1.BaslangicTarih).format('YYYY-MM-DD'),
                                            //end: moment(item_1.BitisTarih).format('YYYY-MM-DD'),
                                            start: starih + "T" + ssaat,
                                            end: etarih + "T" + esaat,
                                            className: item_1.Sinif,
                                            Iptal: item_1.Iptal
                                        });
                                });
                            });
                            successCallback(olaylar);
                        },
                        error: function (err) {
                            alert(err);
                        }
                    });
                },
                eventRender: function (info) {
                    olaylar = [];
                    var baslangic = new Date(info.event._instance.range.start);
                    if (baslangic.getTimezoneOffset() > 0) {
                        baslangic.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);
                    }
                    var baslangic = timeFormatTakvim(info.event._instance.range.start);
                    var bitis = timeFormatTakvim(info.event._instance.range.end);
                    if (info.event.extendedProps.Iptal) {
                        info.el.querySelector('.fc-time').innerHTML = "<del>" + baslangic + " - " + bitis + "</del>";
                        info.el.querySelector('.fc-title').innerHTML = "<del>" + info.event.title + "</del><br /><del>" + info.event.extendedProps.description + "</del>";
                    }
                    else {
                        info.el.querySelector('.fc-time').innerHTML = "<i>" + baslangic + " - " + bitis + "</i>";
                        info.el.querySelector('.fc-title').innerHTML = "<i>" + info.event.title + "</i><br /><i>" + info.event.extendedProps.description + "</i>";
                    }
                    return info.event.description;
                }
                //},
            });

            calendar.render();
        });

        //Yeni Rezervasyon ekle için ...
        initApp.listFilter($('#paketler_liste'), $('#paketler_liste_arama'));
        initApp.listFilter($('#hizmetler_liste'), $('#hizmetler_liste_arama'));
        initApp.listFilter($('#surecler_liste'), $('#surecler_liste_arama'));
        // Tab Menüleri Aktif Pasif Fonksiyonları
        function RezervasyonBilgileriAktif() {
            $("#Tab-RezervasyonBilgileri").addClass("active");
            $("#Tab-MusteriBilgileri").removeClass("active");
            $("#Tab-DigerBilgiler").removeClass("active");
            $("#Tab-PaketVeEkhizmetler").removeClass("active");
            $("#Tab-Surecler").removeClass("active");
            $("#Tab-CekimRandevu").removeClass("active");
            $("#Tab-OdemeBilgileri").removeClass("active");
            $("#Tab-SozlesmeOnizleme").removeClass("active");

            $("#Tab-RezervasyonBilgileri").removeClass("disabled");
            $("#Tab-MusteriBilgileri").addClass("disabled");
            $("#Tab-DigerBilgiler").addClass("disabled");
            $("#Tab-PaketVeEkhizmetler").addClass("disabled");
            $("#Tab-Surecler").addClass("disabled");
            $("#Tab-CekimRandevu").addClass("disabled");
            $("#Tab-OdemeBilgileri").addClass("disabled");
            $("#Tab-SozlesmeOnizleme").addClass("disabled");

            $("#TabPanel-RezervasyonBilgileri").addClass("active show");
            $("#TabPanel-MusteriBilgileri").removeClass("active show");
            $("#TabPanel-DigerBilgiler").removeClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").removeClass("active show");
            $("#TabPanel-Surecler").removeClass("active show");
            $("#TabPanel-CekimRandevu").removeClass("active show");
            $("#TabPanel-OdemeBilgileri").removeClass("active show");
            $("#TabPanel-SozlesmeOnizleme").removeClass("active show");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "true");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "false");
            $("#Tab-DigerBilgiler").attr("aria-selected", "false");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "false");
            $("#Tab-Surecler").attr("aria-selected", "false");
            $("#Tab-CekimRandevu").attr("aria-selected", "false");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "false");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "false");
        };
        function MusteriBilgileriAktif() {
            $("#Tab-RezervasyonBilgileri").removeClass("active");
            $("#Tab-MusteriBilgileri").addClass("active");
            $("#Tab-DigerBilgiler").removeClass("active");
            $("#Tab-PaketVeEkhizmetler").removeClass("active");
            $("#Tab-Surecler").removeClass("active");
            $("#Tab-CekimRandevu").removeClass("active");
            $("#Tab-OdemeBilgileri").removeClass("active");
            $("#Tab-SozlesmeOnizleme").removeClass("active");

            $("#Tab-RezervasyonBilgileri").addClass("disabled");
            $("#Tab-MusteriBilgileri").removeClass("disabled");
            $("#Tab-DigerBilgiler").addClass("disabled");
            $("#Tab-PaketVeEkhizmetler").addClass("disabled");
            $("#Tab-Surecler").addClass("disabled");
            $("#Tab-CekimRandevu").addClass("disabled");
            $("#Tab-OdemeBilgileri").addClass("disabled");
            $("#Tab-SozlesmeOnizleme").addClass("disabled");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "false");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "true");
            $("#Tab-DigerBilgiler").attr("aria-selected", "false");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "false");
            $("#Tab-Surecler").attr("aria-selected", "false");
            $("#Tab-CekimRandevu").attr("aria-selected", "false");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "false");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "false");

            $("#TabPanel-RezervasyonBilgileri").removeClass("active show");
            $("#TabPanel-MusteriBilgileri").addClass("active show");
            $("#TabPanel-DigerBilgiler").removeClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").removeClass("active show");
            $("#TabPanel-Surecler").removeClass("active show");
            $("#TabPanel-CekimRandevu").removeClass("active show");
            $("#TabPanel-OdemeBilgileri").removeClass("active show");
            $("#TabPanel-SozlesmeOnizleme").removeClass("active show");
        };
        function DigerBilgilerAktif() {
            $("#Tab-RezervasyonBilgileri").removeClass("active");
            $("#Tab-MusteriBilgileri").removeClass("active");
            $("#Tab-DigerBilgiler").addClass("active");
            $("#Tab-PaketVeEkhizmetler").removeClass("active");
            $("#Tab-Surecler").removeClass("active");
            $("#Tab-CekimRandevu").removeClass("active");
            $("#Tab-OdemeBilgileri").removeClass("active");
            $("#Tab-SozlesmeOnizleme").removeClass("active");

            $("#Tab-RezervasyonBilgileri").addClass("disabled");
            $("#Tab-MusteriBilgileri").addClass("disabled");
            $("#Tab-DigerBilgiler").removeClass("disabled");
            $("#Tab-PaketVeEkhizmetler").addClass("disabled");
            $("#Tab-Surecler").addClass("disabled");
            $("#Tab-CekimRandevu").addClass("disabled");
            $("#Tab-OdemeBilgileri").addClass("disabled");
            $("#Tab-SozlesmeOnizleme").addClass("disabled");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "false");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "false");
            $("#Tab-DigerBilgiler").attr("aria-selected", "true");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "false");
            $("#Tab-Surecler").attr("aria-selected", "false");
            $("#Tab-CekimRandevu").attr("aria-selected", "false");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "false");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "false");

            $("#TabPanel-RezervasyonBilgileri").removeClass("active show");
            $("#TabPanel-MusteriBilgileri").removeClass("active show");
            $("#TabPanel-DigerBilgiler").addClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").removeClass("active show");
            $("#TabPanel-Surecler").removeClass("active show");
            $("#TabPanel-CekimRandevu").removeClass("active show");
            $("#TabPanel-OdemeBilgileri").removeClass("active show");
            $("#TabPanel-SozlesmeOnizleme").removeClass("active show");
        };
        function PaketVeEkhizmetlerAktif() {
            $("#Tab-RezervasyonBilgileri").removeClass("active");
            $("#Tab-MusteriBilgileri").removeClass("active");
            $("#Tab-DigerBilgiler").removeClass("active");
            $("#Tab-PaketVeEkhizmetler").addClass("active");
            $("#Tab-Surecler").removeClass("active");
            $("#Tab-CekimRandevu").removeClass("active");
            $("#Tab-OdemeBilgileri").removeClass("active");
            $("#Tab-SozlesmeOnizleme").removeClass("active");

            $("#Tab-RezervasyonBilgileri").addClass("disabled");
            $("#Tab-MusteriBilgileri").addClass("disabled");
            $("#Tab-DigerBilgiler").addClass("disabled");
            $("#Tab-PaketVeEkhizmetler").removeClass("disabled");
            $("#Tab-Surecler").addClass("disabled");
            $("#Tab-CekimRandevu").addClass("disabled");
            $("#Tab-OdemeBilgileri").addClass("disabled");
            $("#Tab-SozlesmeOnizleme").addClass("disabled");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "false");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "false");
            $("#Tab-DigerBilgiler").attr("aria-selected", "false");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "true");
            $("#Tab-Surecler").attr("aria-selected", "false");
            $("#Tab-CekimRandevu").attr("aria-selected", "false");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "false");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "false");

            $("#TabPanel-RezervasyonBilgileri").removeClass("active show");
            $("#TabPanel-MusteriBilgileri").removeClass("active show");
            $("#TabPanel-DigerBilgiler").removeClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").addClass("active show");
            $("#TabPanel-Surecler").removeClass("active show");
            $("#TabPanel-CekimRandevu").removeClass("active show");
            $("#TabPanel-OdemeBilgileri").removeClass("active show");
            $("#TabPanel-SozlesmeOnizleme").removeClass("active show");
        };
        function SureclerAktif() {
            $("#Tab-RezervasyonBilgileri").removeClass("active");
            $("#Tab-MusteriBilgileri").removeClass("active");
            $("#Tab-DigerBilgiler").removeClass("active");
            $("#Tab-PaketVeEkhizmetler").removeClass("active");
            $("#Tab-Surecler").addClass("active");
            $("#Tab-CekimRandevu").removeClass("active");
            $("#Tab-OdemeBilgileri").removeClass("active");
            $("#Tab-SozlesmeOnizleme").removeClass("active");

            $("#Tab-RezervasyonBilgileri").addClass("disabled");
            $("#Tab-MusteriBilgileri").addClass("disabled");
            $("#Tab-DigerBilgiler").addClass("disabled");
            $("#Tab-PaketVeEkhizmetler").addClass("disabled");
            $("#Tab-Surecler").removeClass("disabled");
            $("#Tab-CekimRandevu").addClass("disabled");
            $("#Tab-OdemeBilgileri").addClass("disabled");
            $("#Tab-SozlesmeOnizleme").addClass("disabled");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "false");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "false");
            $("#Tab-DigerBilgiler").attr("aria-selected", "false");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "false");
            $("#Tab-Surecler").attr("aria-selected", "true");
            $("#Tab-CekimRandevu").attr("aria-selected", "false");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "false");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "false");

            $("#TabPanel-RezervasyonBilgileri").removeClass("active show");
            $("#TabPanel-MusteriBilgileri").removeClass("active show");
            $("#TabPanel-DigerBilgiler").removeClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").removeClass("active show");
            $("#TabPanel-Surecler").addClass("active show");
            $("#TabPanel-CekimRandevu").removeClass("active show");
            $("#TabPanel-OdemeBilgileri").removeClass("active show");
            $("#TabPanel-SozlesmeOnizleme").removeClass("active show");
        };
        function CekimRandevuAktif() {
            $("#Tab-RezervasyonBilgileri").removeClass("active");
            $("#Tab-MusteriBilgileri").removeClass("active");
            $("#Tab-DigerBilgiler").removeClass("active");
            $("#Tab-PaketVeEkhizmetler").removeClass("active");
            $("#Tab-Surecler").removeClass("active");
            $("#Tab-CekimRandevu").addClass("active");
            $("#Tab-OdemeBilgileri").removeClass("active");
            $("#Tab-SozlesmeOnizleme").removeClass("active");

            $("#Tab-RezervasyonBilgileri").addClass("disabled");
            $("#Tab-MusteriBilgileri").addClass("disabled");
            $("#Tab-DigerBilgiler").addClass("disabled");
            $("#Tab-PaketVeEkhizmetler").addClass("disabled");
            $("#Tab-Surecler").addClass("disabled");
            $("#Tab-CekimRandevu").removeClass("disabled");
            $("#Tab-OdemeBilgileri").addClass("disabled");
            $("#Tab-SozlesmeOnizleme").addClass("disabled");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "false");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "false");
            $("#Tab-DigerBilgiler").attr("aria-selected", "false");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "false");
            $("#Tab-Surecler").attr("aria-selected", "false");
            $("#Tab-CekimRandevu").attr("aria-selected", "true");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "false");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "false");

            $("#TabPanel-RezervasyonBilgileri").removeClass("active show");
            $("#TabPanel-MusteriBilgileri").removeClass("active show");
            $("#TabPanel-DigerBilgiler").removeClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").removeClass("active show");
            $("#TabPanel-Surecler").removeClass("active show");
            $("#TabPanel-CekimRandevu").addClass("active show");
            $("#TabPanel-OdemeBilgileri").removeClass("active show");
            $("#TabPanel-SozlesmeOnizleme").removeClass("active show");
        };
        function OdemeBilgileriAktif() {
            $("#Tab-RezervasyonBilgileri").removeClass("active");
            $("#Tab-MusteriBilgileri").removeClass("active");
            $("#Tab-DigerBilgiler").removeClass("active");
            $("#Tab-PaketVeEkhizmetler").removeClass("active");
            $("#Tab-Surecler").removeClass("active");
            $("#Tab-CekimRandevu").removeClass("active");
            $("#Tab-OdemeBilgileri").addClass("active");
            $("#Tab-SozlesmeOnizleme").removeClass("active");

            $("#Tab-RezervasyonBilgileri").addClass("disabled");
            $("#Tab-MusteriBilgileri").addClass("disabled");
            $("#Tab-DigerBilgiler").addClass("disabled");
            $("#Tab-PaketVeEkhizmetler").addClass("disabled");
            $("#Tab-Surecler").addClass("disabled");
            $("#Tab-CekimRandevu").addClass("disabled");
            $("#Tab-OdemeBilgileri").removeClass("disabled");
            $("#Tab-SozlesmeOnizleme").addClass("disabled");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "false");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "false");
            $("#Tab-DigerBilgiler").attr("aria-selected", "false");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "false");
            $("#Tab-Surecler").attr("aria-selected", "false");
            $("#Tab-CekimRandevu").attr("aria-selected", "false");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "true");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "false");

            $("#TabPanel-RezervasyonBilgileri").removeClass("active show");
            $("#TabPanel-MusteriBilgileri").removeClass("active show");
            $("#TabPanel-DigerBilgiler").removeClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").removeClass("active show");
            $("#TabPanel-Surecler").removeClass("active show");
            $("#TabPanel-CekimRandevu").removeClass("active show");
            $("#TabPanel-OdemeBilgileri").addClass("active show");
            $("#TabPanel-SozlesmeOnizleme").removeClass("active show");
        };
        function SozlesmeOnizlemeAktif() {
            $("#Tab-RezervasyonBilgileri").removeClass("active");
            $("#Tab-MusteriBilgileri").removeClass("active");
            $("#Tab-DigerBilgiler").removeClass("active");
            $("#Tab-PaketVeEkhizmetler").removeClass("active");
            $("#Tab-Surecler").removeClass("active");
            $("#Tab-CekimRandevu").removeClass("active");
            $("#Tab-OdemeBilgileri").removeClass("active");
            $("#Tab-SozlesmeOnizleme").addClass("active");

            $("#Tab-RezervasyonBilgileri").addClass("disabled");
            $("#Tab-MusteriBilgileri").addClass("disabled");
            $("#Tab-DigerBilgiler").addClass("disabled");
            $("#Tab-PaketVeEkhizmetler").addClass("disabled");
            $("#Tab-Surecler").addClass("disabled");
            $("#Tab-CekimRandevu").addClass("disabled");
            $("#Tab-OdemeBilgileri").addClass("disabled");
            $("#Tab-SozlesmeOnizleme").removeClass("disabled");

            $("#Tab-RezervasyonBilgileri").attr("aria-selected", "false");
            $("#Tab-MusteriBilgileri").attr("aria-selected", "false");
            $("#Tab-DigerBilgiler").attr("aria-selected", "false");
            $("#Tab-PaketVeEkhizmetler").attr("aria-selected", "false");
            $("#Tab-Surecler").attr("aria-selected", "false");
            $("#Tab-CekimRandevu").attr("aria-selected", "false");
            $("#Tab-OdemeBilgileri").attr("aria-selected", "false");
            $("#Tab-SozlesmeOnizleme").attr("aria-selected", "true");

            $("#TabPanel-RezervasyonBilgileri").removeClass("active show");
            $("#TabPanel-MusteriBilgileri").removeClass("active show");
            $("#TabPanel-DigerBilgiler").removeClass("active show");
            $("#TabPanel-PaketVeEkhizmetler").removeClass("active show");
            $("#TabPanel-Surecler").removeClass("active show");
            $("#TabPanel-CekimRandevu").removeClass("active show");
            $("#TabPanel-OdemeBilgileri").removeClass("active show");
            $("#TabPanel-SozlesmeOnizleme").addClass("active show");
        };
        function dateFormat(d) {
            return (d.getDate() + "").padStart(2, "0") + "." + ((d.getMonth() + 1) + "").padStart(2, "0") + "." + d.getFullYear();
        }
        function timeFormat(t) {
            var saat = t.getHours();
            var dakika = t.getMinutes();
            var zaman = saat + ":" + dakika
            return zaman;
        }
        function ParaFormat(fiyat) {
            var para_sembol = "TL"
            var format = new Intl.NumberFormat('de-DE', {
                style: 'currency',
                currency: 'TRY',
                minumumFractionDigits: 2
            })
            //return format.format(fiyat)
            return format.format(fiyat).replace('TRY', para_sembol)
        }


        $(":input").inputmask();

        $('#slimtest1').slimScroll(
            {
                position: 'right',
                height: '250px',
                railVisible: true,
                alwaysVisible: true
            });
        $('#slimtest2').slimScroll(
            {
                position: 'right',
                height: '250px',
                railVisible: true,
                alwaysVisible: true
            });
        $('#slimtest3').slimScroll(
            {
                position: 'right',
                height: '250px',
                railVisible: true,
                alwaysVisible: true
            });
        $('#slimtest4').slimScroll(
            {
                position: 'right',
                height: '250px',
                railVisible: true,
                alwaysVisible: true
            });
        $('#slimtest5').slimScroll(
            {
                position: 'right',
                height: '350px',
                railVisible: true,
                alwaysVisible: true
            });
        $('#personellist').slimScroll(
            {
                position: 'right',
                height: '160px',
                railVisible: true,
                alwaysVisible: true
            });
        $('#sozlesmepersonellist').slimScroll(
            {
                position: 'right',
                height: '250px',
                railVisible: true,
                alwaysVisible: true
            });
        $("#PaketTutar").inputmask("currency",
            {
                placeholder: "0.00", // Varsayılan değer
                prefix: "", // öndeki değer
                suffix: " TL", // sondaki değer
                rightAlign: false, // sağa-sola yaslama
                radixPoint: ",", // kuruş ayıracı
                groupSeparator: "." // binlik ayıracı
            });
        $("#Iskonto").inputmask("currency",
            {
                placeholder: "0.00", // Varsayılan değer
                prefix: "", // öndeki değer
                suffix: " TL", // sondaki değer
                rightAlign: false, // sağa-sola yaslama
                radixPoint: ",", // kuruş ayıracı
                groupSeparator: "." // binlik ayıracı
            });
        $("#EkHizmetTutar").inputmask("currency",
            {
                placeholder: "0.00", // Varsayılan değer
                prefix: "", // öndeki değer
                suffix: " TL", // sondaki değer
                rightAlign: false, // sağa-sola yaslama
                radixPoint: ",", // kuruş ayıracı
                groupSeparator: "." // binlik ayıracı
            });
        $("#ToplamTutar").inputmask("currency",
            {
                placeholder: "0.00", // Varsayılan değer
                prefix: "", // öndeki değer
                suffix: " TL", // sondaki değer
                rightAlign: false, // sağa-sola yaslama
                radixPoint: ",", // kuruş ayıracı
                groupSeparator: "." // binlik ayıracı
            });
        $("#OdemeTutar").inputmask("currency",
            {
                placeholder: "0.00", // Varsayılan değer
                prefix: "", // öndeki değer
                suffix: " TL", // sondaki değer
                rightAlign: false, // sağa-sola yaslama
                radixPoint: ",", // kuruş ayıracı
                groupSeparator: "." // binlik ayıracı
            });
        $("#KalanOdemeTutar").inputmask("currency",
            {
                placeholder: "0.00", // Varsayılan değer
                prefix: "", // öndeki değer
                suffix: " TL", // sondaki değer
                rightAlign: false, // sağa-sola yaslama
                radixPoint: ",", // kuruş ayıracı
                groupSeparator: "." // binlik ayıracı
            });
        $("#SilinenTutar").inputmask("currency",
            {
                placeholder: "0.00", // Varsayılan değer
                prefix: "", // öndeki değer
                suffix: " TL", // sondaki değer
                rightAlign: false, // sağa-sola yaslama
                radixPoint: ",", // kuruş ayıracı
                groupSeparator: "." // binlik ayıracı
            });
        //Yeni Rezervasyon ekle için ...
        var controls = {
            leftArrow: '<i class="fal fa-angle-left" style="font-size: 1.25rem"></i>',
            rightArrow: '<i class="fal fa-angle-right" style="font-size: 1.25rem"></i>'
        }
        var runDatePicker = function () {
            //Yeni Rezervasyon ekle için ...
            $('#SozlesmeTarihi').datepicker(
                {
                    todayBtn: "linked",
                    todayHighlight: true,
                    templates: controls,
                    language: 'tr',
                    autoclose: true
                }).datepicker("setDate", new Date());
            $('#OpsiyonTarihi').datepicker(
                {
                    todayBtn: "linked",
                    todayHighlight: true,
                    templates: controls,
                    language: 'tr',
                    autoclose: true
                }).datepicker("setDate", new Date());
            $('#RezervasyonTarihi').datepicker(
                {
                    todayBtn: "linked",
                    todayHighlight: true,
                    templates: controls,
                    language: 'tr',
                    autoclose: true
                }).datepicker("setDate", new Date());
            $('#OdemeTarihi').datepicker(
                {
                    todayBtn: "linked",
                    todayHighlight: true,
                    templates: controls,
                    language: 'tr',
                    autoclose: true
                }).datepicker("setDate", new Date());
            $('#KalanOdemeTarihi').datepicker(
                {
                    todayBtn: "linked",
                    todayHighlight: true,
                    templates: controls,
                    language: 'tr',
                    autoclose: true
                }).datepicker("setDate", new Date());
            $('#CekimTarihi').datepicker(
                {
                    todayBtn: "linked",
                    todayHighlight: true,
                    templates: controls,
                    language: 'tr',
                    autoclose: true
                }).datepicker("setDate", new Date());
            $('#RandevuEkleCekimTarihi').datepicker(
                {
                    todayBtn: "linked",
                    todayHighlight: true,
                    templates: controls,
                    language: 'tr',
                    autoclose: true
                }).datepicker("setDate", new Date());
            //Yeni Rezervasyon ekle için ...
        }

        $(document).ready(function () {
            //Yeni Rezervasyon ekle için ...
            $(function () {
                $('#MusteriId').select2({
                    dropdownParent: $('#YeniRezervasyonEkleModal')
                });
                $('#GGTurId').select2({
                    dropdownParent: $('#YeniGelirGiderEkleModal')
                    //dropdownParent: $('#KayitDuzenleModal')
                });
                $('#GisMusteriId').select2({
                    dropdownParent: $('#YeniGisEkleModal')
                });
            });
            var OdemeAlDurum = false;
            // ------  Paket ve EkHizmetler Sekmesi hesaplama ve yazma işlemleri  ------ //
            var formattedOutput = new Intl.NumberFormat('tr-TR', {
                style: 'currency',
                currency: 'TRY',
                minimumFractionDigits: 2,
            });
            var ToplamTutar = 0;
            var paketfiyat = 0;
            var toplampaketfiyat = 0;
            var ekhizmetfiyat = 0;
            var toplamekhizmetfiyat = 0;
            var iskonto = 0;
            var sozlesmeId = 0; var sozlesmeNo; var musteriid;
            var alacaktoplam = 0; // kalan ödeme toplamları global
            var sozlesmeId = 0; var sozlesmeNo; var musteriid = 0; var randevuId = 0;
            var secilenpaketID = [];
            var secilenekhizmetID = [];
            var secilensurecID = [];
            var SozlesmePersonelIdArray = new Array();
            //var PersonelAdiArray = new Array();
            //var PersonelGorevArray = new Array();
            var RandevuPersonelIdArray = new Array();

            runDatePicker();
            RezervasyonBilgileriAktif();

            var SurecListesi = $("#Surecler :checkbox");
            SecilenSurecler();

            function DigerBilgilerBosalt() {
                $("#GelinAdSoyad").val("");
                $("#GelinCep").val("");
                $("#GelinEmail").val("");
                $("#DamatAdSoyad").val("");
                $("#DamatCep").val("");
                $("#DamatEmail").val("");
                $("#BebekAdSoyad").val("");
                $("#BabaAdSoyad").val("");
                $("#AnneAdSoyad").val("");
                $("#BabaCep").val("");
                $("#AnneCep").val("");
                $("#BabaEmail").val("");
                $("#Urunler").val("");
                $("#UrunYetkiliAdSoyad").val("");
                $("#UrunYetkiliCep").val("");
                $("#UrunYetkiliEmail").val("");
                $("#Modeller").val("");
                $("#ModelYetkiliAdSoyad").val("");
                $("#ModelYetkiliCep").val("");
                $("#ModelYetkiliEmail").val("");
                $("#YetkiliAdSoyad").val("");
                $("#YetkiliCep").val("");
                $("#YetkiliEmail").val("");
            }
            DigerBilgilerBosalt();
            function SayfayiTemizle() {

                // Rezervasyon Bilgileri Sayfasını Boşalt
                runDatePicker();
                $("#RezervasyonSekliId").val("0");
                $("#PersonelId").val("0");
                $("#RezervasyonTurId").val("0");
                $("#RezervasyonSekliId").val("0");
                $("#ZamanDilimiId").val("0");
                $("#OrganizasyonYeri").val("");
                $("#BaslangicZaman").val("00:00");
                $("#BitisZaman").val("00:00");
                // Rezervasyon Bilgileri Sayfasını Boşalt

                // Müşteri Bilgileri Sayfasını Boşalt
                $("#MusteriId").val("0");
                $("#AdSoyad").val("");
                $("#TCKimlikNo").val("");
                $("#Email").val("");
                $("#CepTel").val("");
                $("#SabitTel").val("");
                $("#Adres").val("");
                $("#Notlar").val("");
                // Müşteri Bilgileri Sayfasını Boşalt

                // Diğer Bilgiler Sayfasını Boşalt
                DigerBilgilerBosalt();
                // Diğer Bilgiler Sayfasını Boşalt

                // Paketler/EkHizmetler ve Süreçler Sayfasını Boşalt
                secilenpaketID = [];
                secilenekhizmetID = [];
                secilensurecID = [];
                // Paketler/EkHizmetler Sayfasını Boşalt

                // Çekim Randevuları Sayfasını Boşalt
                $("#CekimBaslangic").val("00:00");
                $("#CekimBitis").val("00:00");
                $("#CekimYeri").val("");
                $("#CekimPersonelId").val("0");
                // Çekim Randevuları Sayfasını Boşalt

                // Ödeme Bilgileri Sayfasını Boşalt
                $("#OdemeTutar").val("0,00 TL");
                $("#OdemeSekli").val("0");
                $("#KalanOdemeTutar").val("0,00 TL");
                $("#OdemeAciklama").val("");
                $("#KalanOdemeAciklama").val("");
                // Ödeme Bilgileri Sayfasını Boşalt
                ToplamTutar = 0;
                paketfiyat = 0;
                toplampaketfiyat = 0;
                ekhizmetfiyat = 0;
                toplamekhizmetfiyat = 0;
                iskonto = 0;

                alacaktoplam = 0; // kalan ödeme toplamları global
            }
            //SayfayiTemizle();
            // ------  Rezervasyon Sekli seçimi
            $("#RezervasyonSekliId").change(function () {
                var rezervasyonsekli = $(this).find("option:selected").val();
                if (rezervasyonsekli == 1) {
                    $("#OpsiyonTarihi").attr("disabled", "true");
                }
                else {
                    $("#OpsiyonTarihi").removeAttr("disabled");
                }
            });
            // ------  Rezervasyon Sekli seçimi

            // ------  Zaman Dilimi seçimi
            $("#ZamanDilimiId").change(function () {
                var zamandilimi = $(this).find("option:selected").val();
                if (zamandilimi != 0) {
                    $("#BaslangicZaman").attr("disabled", "true");
                    $("#BitisZaman").attr("disabled", "true")
                }
                else {
                    $("#BaslangicZaman").removeAttr("disabled");
                    $("#BitisZaman").removeAttr("disabled");
                }
            });
            // ------  Zaman Dilimi seçimi

            // ------  Rezervasyon Türü seçimi
            $("#RezervasyonTurId").change(function () {
                // ------  Rezervasyon Türü değiştiğinde Diğre Bilgilerdeki Textler Boşaltılacak.
                DigerBilgilerBosalt();
                // ------  Rezervasyon Türü değiştiğinde Diğre Bilgilerdeki Textler Boşaltılacak.
                if ($(this).find("option:selected").data("formalan") == "Gelin/Damat") {
                    $(".Gelin").removeAttr("style", "display:none");
                    $(".Damat").removeAttr("style", "display:none");
                    $(".BebekCocuk").attr("style", "display:none");
                    $(".UrunKatalog").attr("style", "display:none");
                    $(".ModelManken").attr("style", "display:none");
                    $(".Yetkili").attr("style", "display:none");
                }
                else if ($(this).find("option:selected").data("formalan") == "Bebek/Çocuk") {
                    $(".Gelin").attr("style", "display:none");
                    $(".Damat").attr("style", "display:none");
                    $(".BebekCocuk").removeAttr("style", "display:none");
                    $(".UrunKatalog").attr("style", "display:none");
                    $(".ModelManken").attr("style", "display:none");
                    $(".Yetkili").attr("style", "display:none");
                }
                else if ($(this).find("option:selected").data("formalan") == "Ürün/Katalog") {
                    $(".Gelin").attr("style", "display:none");
                    $(".Damat").attr("style", "display:none");
                    $(".BebekCocuk").attr("style", "display:none");
                    $(".UrunKatalog").removeAttr("style", "display:none");
                    $(".ModelManken").attr("style", "display:none");
                    $(".Yetkili").attr("style", "display:none");
                }
                else if ($(this).find("option:selected").data("formalan") == "Model/Manken") {
                    $(".Gelin").attr("style", "display:none");
                    $(".Damat").attr("style", "display:none");
                    $(".BebekCocuk").attr("style", "display:none");
                    $(".UrunKatalog").attr("style", "display:none");
                    $(".ModelManken").removeAttr("style", "display:none");
                    $(".Yetkili").attr("style", "display:none");
                }
                else if ($(this).find("option:selected").data("formalan") == "Yetkili") {
                    $(".Gelin").attr("style", "display:none");
                    $(".Damat").attr("style", "display:none");
                    $(".BebekCocuk").attr("style", "display:none");
                    $(".UrunKatalog").attr("style", "display:none");
                    $(".ModelManken").attr("style", "display:none");
                    $(".Yetkili").removeAttr("style", "display:none");
                }
                else {
                    $(".Gelin").removeAttr("style", "display:none");
                    $(".Damat").removeAttr("style", "display:none");
                    $(".BebekCocuk").removeAttr("style", "display:none");
                    $(".UrunKatalog").removeAttr("style", "display:none");
                    $(".ModelManken").removeAttr("style", "display:none");
                    $(".Yetkili").removeAttr("style", "display:none");
                }
            });
            // ------   Rezervasyon Türü seçimi

            // ------ Müşteri Listesinde Müşteri seçimi
            $("#MusteriId").change(function () {
                musteriid = $(this).find("option:selected").val();
                var musterikodu = $(this).find("option:selected").data("musterikodu");
                var adsoyad = $(this).find("option:selected").data("adsoyad");
                var tckimlik = $(this).find("option:selected").data("tckimlikno");
                var email = $(this).find("option:selected").data("email");
                var ceptel = $(this).find("option:selected").data("ceptel");
                var sabittel = $(this).find("option:selected").data("sabittel");
                var adres = $(this).find("option:selected").data("adres");
                var notlar = $(this).find("option:selected").data("notlar");
                if (musteriid != 0) {
                    adres = adres.replace(/\<br \/\>/g, "\r\n");
                    notlar = notlar.replace(/\<br \/\>/g, "\r\n");
                    $("#MusteriKodu").val(musterikodu);
                    $("#AdSoyad").val(adsoyad);
                    $("#TCKimlikNo").val(tckimlik);
                    $("#Email").val(email);
                    $("#CepTel").val(ceptel);
                    $("#SabitTel").val(sabittel);
                    $("#Adres").val(adres);
                    $("#Notlar").val(notlar);

                    $("#AdSoyad").addClass("disabled");
                    $("#TCKimlikNo").addClass("disabled");

                    $("#AdSoyad").attr("disabled", "disabled");
                    $("#TCKimlikNo").attr("disabled", "disabled");
                }
                else {
                    $("#MusteriKodu").val(musterikodu);
                    $("#AdSoyad").val("");
                    $("#TCKimlikNo").val("");
                    $("#Email").val("");
                    $("#CepTel").val("");
                    $("#SabitTel").val("");
                    $("#Adres").val("");
                    $("#Notlar").val("");

                    $("#AdSoyad").removeClass("disabled");
                    $("#TCKimlikNo").removeClass("disabled");

                    $("#AdSoyad").removeAttr("disabled");
                    $("#TCKimlikNo").removeAttr("disabled");
                }
            });
            // ------ Müşteri Listesinde Müşteri seçimi

            // ------ Paketler Listesindeki paket seçimi
            var PaketListesi = $("#Paketler :checkbox");
            PaketListesi.on("change", function () {
                SecilenPaketler();
            });
            function SecilenPaketler() {
                secilenpaketID = [];
                $("#slimtest2").empty();
                toplampaketfiyat = 0;
                if (secilenpaketID.length == 0) {
                    paketfiyat = 0;
                    toplampaketfiyat = 0;
                    ToplamTutar = parseFloat(toplampaketfiyat) + parseFloat(toplamekhizmetfiyat);
                    iskonto = $("#Iskonto").val().replace(" TL", "");
                    iskonto = iskonto.replace(".", "");
                    iskonto = iskonto.replace(",", ".");
                    if (iskonto != "") {
                        var ToplamTutar2 = parseFloat(ToplamTutar) - parseFloat(iskonto);
                        $("#PaketTutar").val(formattedOutput.format(parseFloat(toplampaketfiyat)));
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar2)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                    }
                    else {
                        $("#PaketTutar").val(formattedOutput.format(parseFloat(toplampaketfiyat)));
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                    }
                }
                PaketListesi.filter(":checked").each(function () {
                    secilenpaketID.push($(this).data("paketid"));
                    paketfiyat = $(this).data("fiyat").replace(" TL", "");
                    paketfiyat = paketfiyat.replace(".", "");
                    paketfiyat = paketfiyat.replace(",", ".");
                    toplampaketfiyat = toplampaketfiyat + parseFloat(paketfiyat);

                    $("#PaketTutar").val(formattedOutput.format(parseFloat(toplampaketfiyat)));
                    $("#slimtest2").append("<div class='alert alert-primary mb-2'>" +
                        "<h5 class='card-title'>" + $(this).val() + "<span class='fw-700'> - " + ParaFormat(paketfiyat) + "</span></h5>" +
                        $(this).data("paketdetay") +
                        "</div>");
                    ToplamTutar = parseFloat(toplampaketfiyat) + parseFloat(toplamekhizmetfiyat);
                    iskonto = $("#Iskonto").val().replace(" TL", "");
                    iskonto = iskonto.replace(".", "");
                    iskonto = iskonto.replace(",", ".");
                    if (iskonto != "") {
                        var ToplamTutar2 = parseFloat(ToplamTutar) - parseFloat(iskonto);
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar2)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                    }
                    else {
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                    }
                });

            }
            // ------ Paketler Listesindeki paket seçimi
            // ------ Ek Hizmetler Listesindeki paket seçimi
            var EkHizmetListesi = $("#EkHizmetler :checkbox");
            EkHizmetListesi.on("change", function () {
                SecilenEkHizmetler();
            });
            function SecilenEkHizmetler() {
                secilenekhizmetID = [];
                $("#slimtest4").empty();
                toplamekhizmetfiyat = 0;
                if (secilenekhizmetID.length == 0) {
                    ekhizmetfiyat = 0;
                    toplamekhizmetfiyat = 0;
                    ToplamTutar = parseFloat(toplampaketfiyat) + parseFloat(toplamekhizmetfiyat);
                    iskonto = $("#Iskonto").val().replace(" TL", "");
                    iskonto = iskonto.replace(".", "");
                    iskonto = iskonto.replace(",", ".");
                    if (iskonto != "") {
                        var ToplamTutar2 = parseFloat(ToplamTutar) - parseFloat(iskonto);
                        $("#EkHizmetTutar").val(formattedOutput.format(parseFloat(toplamekhizmetfiyat)));
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar2)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                    }
                    else {
                        $("#EkHizmetTutar").val(formattedOutput.format(parseFloat(toplamekhizmetfiyat)));
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                    }
                }
                EkHizmetListesi.filter(":checked").each(function () {
                    secilenekhizmetID.push($(this).data("ekhizmetid"));
                    ekhizmetfiyat = $(this).data("fiyat").replace(" TL", "");
                    ekhizmetfiyat = ekhizmetfiyat.replace(".", "");
                    ekhizmetfiyat = ekhizmetfiyat.replace(",", ".");
                    toplamekhizmetfiyat = toplamekhizmetfiyat + parseFloat(ekhizmetfiyat);
                    $("#EkHizmetTutar").val(formattedOutput.format(parseFloat(toplamekhizmetfiyat)));
                    $("#slimtest4").append("<div class='alert alert-secondary mb-2'>" +
                        "<h5 class='card-title'>" + $(this).val() + "<span class='fw-700'> - " + ParaFormat(ekhizmetfiyat) + "</span></h5>" +
                        $(this).data("ekhizmetdetay") +
                        "</div>");
                    //ToplamTutar = 0;
                    ToplamTutar = parseFloat(toplampaketfiyat) + parseFloat(toplamekhizmetfiyat);

                    iskonto = $("#Iskonto").val().replace(" TL", "");
                    iskonto = iskonto.replace(".", "");
                    iskonto = iskonto.replace(",", ".");
                    if (iskonto != "") {
                        var ToplamTutar2 = parseFloat(ToplamTutar) - parseFloat(iskonto);
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar2)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                    }
                    else {
                        $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar)));
                        $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                        $("#kalanalacak").html(accounting.formatMoney(ToplamTutar, "TL", 2, ".", ",", "%v %s"));
                    }
                });
            }
            // ------ Ek Hizmetler Listesindeki hizmet seçimi
            // ------ Süreçler Listesindeki süreç seçimi

            SurecListesi.on("change", function () {
                SecilenSurecler();
            });
            function SecilenSurecler() {
                secilensurecID = [];
                SurecListesi.filter(":checked").each(function () {
                    secilensurecID.push($(this).data("surecid"));
                });

            }
            // ------ Süreçler Listesindeki süreç seçimi
            $(".tutarlar").on('change', function () {
                iskonto = $("#Iskonto").val().replace(" TL", "");
                iskonto = iskonto.replace(".", "");
                iskonto = iskonto.replace(",", ".");
                var ToplamTutar2 = parseFloat(ToplamTutar) - parseFloat(iskonto);
                $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar2)));
                $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                $("#kalanalacak").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
            });

            $("#Iskonto").keypress(function () {
                iskonto = $("#Iskonto").val().replace(" TL", "");
                iskonto = iskonto.replace(".", "");
                iskonto = iskonto.replace(",", ".");
                var ToplamTutar2 = parseFloat(ToplamTutar) - parseFloat(iskonto);
                $("#ToplamTutar").val(formattedOutput.format(parseFloat(ToplamTutar2)));
                $("#sozlesmetutari").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                $("#sozlesmekalan").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
                $("#kalanalacak").html(accounting.formatMoney(ToplamTutar2, "TL", 2, ".", ",", "%v %s"));
            });

            // ------  Paket ve EkHizmetler Sekmesi hesaplama ve yazma işlemleri  ------ //

            // ------ Alınan ve Gelecek Ödeme Ekleme/Silme İşlemleri
            $("#AlacakEkle").click(function () {
                var alacakgirilentutar = $("#KalanOdemeTutar").val(); // Eklenecek borç textboxtan okunuyor.
                alacakgirilentutar = alacakgirilentutar.replace(" TL", "");
                alacakgirilentutar = alacakgirilentutar.replace(".", "");
                alacakgirilentutar = alacakgirilentutar.replace(",", ".");

                var kalanalacaktutar = $("#sozlesmekalan").html(); // Kalan borç ilgili alandan okunuyor.
                kalanalacaktutar = kalanalacaktutar.replace("TL", "");
                kalanalacaktutar = kalanalacaktutar.replace(".", "");
                kalanalacaktutar = kalanalacaktutar.replace(",", ".");

                if (parseFloat(alacakgirilentutar) <= parseFloat(kalanalacaktutar)) { // Borç olarak girilen değer kalan borç miktarından küçük olmalıdır. değilse uyarı ver.
                    if ($("#KalanOdemeTutar").val() == "0" || $("#KalanOdemeTutar").val() == "") { // validation kontrol
                        $("#KalanOdemeTutar").focus();
                        $("#KalanTutarHata").append("<div class='kalanodemetutarhata' style='color:red'>Tutar 0(sıfır) olamaz.</div>");
                    }
                    else {
                        var kalanodeme = $("#KalanOdemeTutar").val().replace(" TL", "");
                        var AlacakData = new FormData();
                        AlacakData.append("SozlesmeId", sozlesmeId);
                        AlacakData.append("SozlesmeNo", sozlesmeNo);
                        AlacakData.append("MusteriId", musteriid);
                        AlacakData.append("KalanOdemeTarihi", $("#KalanOdemeTarihi").val());
                        AlacakData.append("KalanOdemeTutar", kalanodeme);
                        AlacakData.append("KalanOdemeAciklama", $("#KalanOdemeAciklama").val());
                        $.ajax({
                            type: "POST",
                            datatype: 'json',
                            data: AlacakData,
                            contentType: false,
                            processData: false,
                            url: "/Otomasyon/RezervasyonIslemleri/AlacakEkle/",
                            success: function (data) {
                                if (data.Sonuc == false) {
                                    alertify.set('notifier', 'delay', 5);
                                    alertify.set('notifier', 'position', 'top-center');
                                    alertify.error(data.Mesaj);
                                }
                                else if (data.Sonuc == true) {
                                    alertify.set('notifier', 'delay', 3);
                                    alertify.set('notifier', 'position', 'top-center');
                                    alertify.success(data.Mesaj);
                                    alacaktoplam = 0; // global değişken sıfırlanıyor.
                                    var alacaktutar = 0;
                                    $("#gelecekodemeler-satir").empty();
                                    $.each(data.data, function (index, item_1) {
                                        alacaktutar = item_1.Tutar;
                                        alacaktoplam = alacaktoplam + parseFloat(alacaktutar);
                                        if (item_1.OdemeAl == true) {
                                            $("#gelecekodemeler-satir").append("<tr class='bg-primary-50' id='gelecekodemeid-" + item_1.Id + "'>" +
                                                "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                "<td class='text-center'>" +
                                                "</td>" +
                                                "</tr>");
                                        }
                                        else {
                                            $("#gelecekodemeler-satir").append("<tr id='gelecekodemeid-" + item_1.Id + "'>" +
                                                "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                "<td class='text-center'>" +
                                                "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 alacaksmsgonder' data-alacakid='" + item_1.Id + "' data-alacaktarih='" + item_1.Tarih + "' data-alacaktutar='" + ParaFormat(item_1.Tutar) + "' title='SMS Gönder'>" +
                                                "<i class='fal fa-mobile-alt'></i>" +
                                                "</a>" +
                                                "<a href='#' class='btn btn-xs btn-success btn-icon mr-1 odemeal' data-alacakid='" + item_1.Id + "' data-alacaktarih='" + item_1.Tarih + "' data-alacaktutar='" + ParaFormat(item_1.Tutar) + "' title='Ödeme Al'>" +
                                                "<i class='fal fa-plus-octagon'></i>" +
                                                "</a>" +
                                                "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 alacaksil' data-alacakid='" + item_1.Id + "' data-alacaktarih='" + item_1.Tarih + "' data-alacaktutar='" + ParaFormat(item_1.Tutar) + "' title='Borcu Sil'>" +
                                                "<i class='fal fa-trash-alt'></i>" +
                                                "</a>" +
                                                "</td>" +
                                                "</tr>");
                                        }
                                    });
                                    kalanalacaktutar = parseFloat(kalanalacaktutar) - parseFloat(alacakgirilentutar); // Kalan alacak miktarı ilgili alandan okunmuştu. bu miktardan toplam alacak tutarı düşülerek ilgili alana yeniden yazılıyor.
                                    $("#sozlesmekalan").html(accounting.formatMoney(kalanalacaktutar, "TL", 2, ".", ",", "%v %s"));
                                    $("#kalanodemetoplam2").html(accounting.formatMoney(alacaktoplam, "TL", 2, ".", ",", "%v %s"));
                                    $("#kalanodemetoplam").html(accounting.formatMoney(alacaktoplam, "TL", 2, ".", ",", "%v %s"));
                                    $("#KalanOdemeTarihi").val(dateFormat(new Date()));
                                    $("#KalanOdemeTutar").val("");
                                    $("#KalanOdemeAciklama").val("");
                                }
                            },
                            error: function (err) {
                                $("#YeniRezervasyonEkleModal").modal("hide");
                                alert("HATA");
                            }
                        });
                    }
                }
                else {
                    Swal.fire(
                        {
                            title: "Borç Uyarı",
                            html: "<p style='color:red'> Sözleşme Tutarından veya Kalan Tutardan fazla bir borç ekleyemezsiniz!</p>",
                            type: "warning",
                            confirmButtonText: "Tamam"
                        });
                }
            });
            $("#tb-gelecekodemeler").on('click', '.alacaksil', function () {
                var id = $(this).data("alacakid");
                var tarih = $(this).data("alacaktarih");
                var tutar = $(this).data("alacaktutar");

                var kalan = $("#sozlesmekalan").html(); // Ödemeler tarafında Son kalan tutar
                kalan = kalan.replace("TL", "");
                kalan = kalan.replace(".", "");
                kalan = kalan.replace(",", ".");

                var kalanodemelertoplam = $("#kalanodemetoplam2").html(); // Kalan borç ilgili alandan okunuyor.
                kalanodemelertoplam = kalanodemelertoplam.replace("TL", "");
                kalanodemelertoplam = kalanodemelertoplam.replace(".", "");
                kalanodemelertoplam = kalanodemelertoplam.replace(",", ".");

                var silinentutar = tutar.replace(" TL", "");
                silinentutar = silinentutar.replace(".", "");
                silinentutar = silinentutar.replace(",", ".");

                Swal.fire(
                    {
                        title: "Kalan Ödeme Sil",
                        html: "<p style='color:red;font-weight:bold;font-size:12pt;'>&laquo; " + tarih + " - " + tutar + " &raquo;</p> <p style='color:red;font-size:12pt;'><h3> Kalan Ödeme silinsin mi?</h3></p> ",
                        type: "error",
                        showCancelButton: true,
                        confirmButtonText: "Sil!",
                        cancelButtonText: "İptal"
                    }).then(function (result) {
                        if (result.value) {
                            $.ajax({
                                type: "POST",
                                datatype: 'json',
                                contentType: false,
                                processData: false,
                                url: "/Otomasyon/RezervasyonIslemleri/AlacakSil/" + id,
                                success: function (data) {
                                    if (data.Sonuc == false) {
                                        alertify.set('notifier', 'delay', 5);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.error(data.Mesaj);
                                    }
                                    else if (data.Sonuc == true) {
                                        alertify.set('notifier', 'delay', 3);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.success(data.Mesaj);
                                        var alacaktoplam = 0;
                                        var alacaktutar = 0;
                                        $("#gelecekodemeler-satir").empty();
                                        $.each(data.data, function (index, item_1) {
                                            alacaktutar = item_1.Tutar;
                                            alacaktoplam = alacaktoplam + parseFloat(alacaktutar);
                                            if (item_1.OdemeAl == true) {
                                                $("#gelecekodemeler-satir").append("<tr class='bg-primary-50' id='gelecekodemeid-" + item_1.Id + "'>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                            else {
                                                $("#gelecekodemeler-satir").append("<tr id='gelecekodemeid-" + item_1.Id + "'>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 alacaksmsgonder' data-alacakid='" + item_1.Id + "' data-alacaktarih='" + item_1.Tarih + "' data-alacaktutar='" + ParaFormat(item_1.Tutar) + "' title='SMS Gönder'>" +
                                                    "<i class='fal fa-mobile-alt'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-success btn-icon mr-1 odemeal' data-toggle='modal' data-target='#OdemeAlModal' data-alacakid='" + item_1.Id + "' data-alacaktarih='" + item_1.Tarih + "' data-alacaktutar='" + ParaFormat(item_1.Tutar) + "' title='Ödeme Al'>" +
                                                    "<i class='fal fa-plus-octagon'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 alacaksil' data-alacakid='" + item_1.Id + "' data-alacaktarih='" + item_1.Tarih + "' data-alacaktutar='" + ParaFormat(item_1.Tutar) + "' title='Borcu Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                        });
                                        var kalanbakiye = parseFloat(kalan) + parseFloat(silinentutar);
                                        $("#kalanodemetoplam2").html(accounting.formatMoney(alacaktoplam, "TL", 2, ".", ",", "%v %s"));
                                        $("#kalanodemetoplam").html(accounting.formatMoney(alacaktoplam, "TL", 2, ".", ",", "%v %s"));
                                        $("#sozlesmekalan").html(accounting.formatMoney(kalanbakiye, "TL", 2, ".", ",", "%v %s"));
                                        $("#KalanOdemeTarihi").val(dateFormat(new Date()));
                                        $("#KalanOdemeTutar").val("");
                                        $("#KalanOdemeAciklama").val("");
                                    }
                                },
                                error: function (err) {
                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                    alert("HATA");
                                }
                            });
                        }
                    });
            }); // Kalan Ödeme Sil
            $("#tb-gelecekodemeler").on('click', '.odemeal', function () {
                var id = $(this).data("alacakid");
                var tarih = $(this).data("alacaktarih");
                var tutar = $(this).data("alacaktutar");
                $("#OdemeTarihi").data("alacakid", id);
                $("#OdemeTarihi").data("alacaktutar", tutar);
                $("#OdemeTarihi").val($(this).data("alacaktarih"));
                $("#OdemeTutar").val($(this).data("alacaktutar"));
                //$("#OdemeSekli").focus();
                OdemeAlDurum = true;
            }); // BorcuÖdemeye dönüştür
            $("#tb-gelecekodemeler").on('click', '.alacaksmsgonder', function () {
                var id = $(this).data("alacakid");
                $.ajax({
                    type: "POST",
                    datatype: 'json',
                    //data: SMSGonderData,
                    contentType: false,
                    processData: false,
                    url: "/Otomasyon/RezervasyonIslemleri/AlacakOdemeSMSAyarKotrol/",
                    success: function (data) {
                        if (data.Sonuc == false) {
                            Swal.fire(
                                {
                                    title: "Bilgi SMS'i Gönder",
                                    //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                                    html: "<p style='color:red;font-size:12pt;'><h3> " + data.Mesaj + " </h3></p> ",
                                    type: "warning",
                                    showCancelButton: false,
                                    confirmButtonText: "Tamam!"
                                })
                        }
                        else if (data.Sonuc == true) {
                            Swal.fire(
                                {
                                    title: "Bilgi SMS'i Gönder",
                                    //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                                    html: "<p style='color:red;font-size:12pt;'><h3> Müşteriye Borç Bilgi SMS'i gönderilsin mi?</h3></p> ",
                                    type: "warning",
                                    showCancelButton: true,
                                    confirmButtonText: "Gönder!"
                                }).then(function (result) {
                                    if (result.value) {

                                        var SMSGonderData = new FormData();
                                        SMSGonderData.append("MusteriId", musteriid);
                                        SMSGonderData.append("SozlesmeId", sozlesmeId);
                                        SMSGonderData.append("AlacakId", id);
                                        $.ajax({
                                            type: "POST",
                                            datatype: 'json',
                                            data: SMSGonderData,
                                            contentType: false,
                                            processData: false,
                                            beforeSend: function () {
                                                Swal.fire(
                                                    {
                                                        title: "Müşteriye Bilgi SMS'i Gönderiliyor!",
                                                        html: "<strong>Lütfen Bekleyin.</strong>",
                                                        onBeforeOpen: function onBeforeOpen() {
                                                            Swal.showLoading();
                                                        }
                                                    });
                                            },
                                            url: "/Otomasyon/RezervasyonIslemleri/AlacakOdemeSMSGonder/",
                                            success: function (data) {
                                                if (data.Sonuc == false) {
                                                    alertify.set('notifier', 'delay', 5);
                                                    alertify.set('notifier', 'position', 'top-center');
                                                    alertify.error(data.Mesaj);
                                                    swal.close();
                                                }
                                                else if (data.Sonuc == true) {
                                                    alertify.set('notifier', 'delay', 3);
                                                    alertify.set('notifier', 'position', 'top-center');
                                                    alertify.success(data.Mesaj);
                                                    swal.close();
                                                }
                                            },
                                            error: function (err) {
                                                alert("HATA");
                                            }
                                        });
                                    }
                                });
                        }
                    },
                    error: function (err) {
                        alert("HATA");
                    }
                });
            }); // Alacak Ödeme Bilgi SMS i gönder

            $("#OdemeAl").click(function () {
                var OdemeAlId = $("#OdemeTarihi").data("alacakid");

                var odemetutar = $("#OdemeTutar").val();
                odemetutar = odemetutar.replace(" TL", "");
                odemetutar = odemetutar.replace(".", "");
                odemetutar = odemetutar.replace(",", ".");

                var kalanbakiye = $("#sozlesmekalan").html();
                kalanbakiye = kalanbakiye.replace(" TL", "");
                kalanbakiye = kalanbakiye.replace(".", "");
                kalanbakiye = kalanbakiye.replace(",", ".");

                var SozlesmeTutar = $("#sozlesmetutari").html();
                SozlesmeTutar = SozlesmeTutar.replace(" TL", "");
                SozlesmeTutar = SozlesmeTutar.replace(".", "");
                SozlesmeTutar = SozlesmeTutar.replace(",", ".");

                var SozlesmeKalan = $("#sozlesmekalan").html();
                SozlesmeKalan = SozlesmeKalan.replace(" TL", "");
                SozlesmeKalan = SozlesmeKalan.replace(".", "");
                SozlesmeKalan = SozlesmeKalan.replace(",", ".");

                var KalanOdemeToplam = $("#kalanodemetoplam").html();
                KalanOdemeToplam = KalanOdemeToplam.replace(" TL", "");
                KalanOdemeToplam = KalanOdemeToplam.replace(".", "");
                KalanOdemeToplam = KalanOdemeToplam.replace(",", ".");

                if (OdemeAlDurum == true) { // Eğer Borçtan ödeme alınıyorsa kalan bakiye kontrolü yapılmayacak
                    var girilentutar = $("#OdemeTutar").val().replace(" ", "");
                    girilentutar = girilentutar.replace("TL", "");
                    girilentutar = girilentutar.replace(".", "");
                    girilentutar = girilentutar.replace(",", ".");
                    var alacaktutar = $("#OdemeTarihi").data("alacaktutar").replace(" ", "");
                    alacaktutar = alacaktutar.replace("TL", "");
                    alacaktutar = alacaktutar.replace(".", "");
                    alacaktutar = alacaktutar.replace(",", ".");

                    if (parseFloat(alacaktutar) != parseFloat(girilentutar)) {
                        Swal.fire(
                            {
                                title: "Borç Uyarı",
                                html: "<p style='color:red'> Girilen Tutar ile Alacak Tutar aynı değil!</p>",
                                type: "warning",
                                confirmButtonText: "Tamam"
                            });
                    }
                    else {
                        if ($("#OdemeTutar").val() == "0" || $("#OdemeTutar").val() == "") {
                            $("#OdemeTutar").focus();
                            $("#OdemeTutarHata").append("<div class='odemetutarhata' style='color:red'>Tutar 0(sıfır) olamaz.</div>");
                        }
                        else {
                            var AlinanOdemeData = new FormData();
                            AlinanOdemeData.append("SozlesmeId", sozlesmeId);
                            AlinanOdemeData.append("SozlesmeNo", sozlesmeNo);
                            AlinanOdemeData.append("OdemeAdSoyad", $("#AdSoyad").val());
                            AlinanOdemeData.append("MusteriId", musteriid);
                            AlinanOdemeData.append("OdemeAlDurum", OdemeAlDurum);
                            AlinanOdemeData.append("OdemeAlacakId", $("#OdemeTarihi").data("alacakid"));
                            AlinanOdemeData.append("OdemeTarihi", $("#OdemeTarihi").val());
                            AlinanOdemeData.append("OdemeTutar", $("#OdemeTutar").val().replace(" TL", ""));
                            AlinanOdemeData.append("OdemeSekli", $("#OdemeSekli").find("option:selected").text());
                            AlinanOdemeData.append("OdemeAciklama", $("#OdemeAciklama").val());
                            $.ajax({
                                type: "POST",
                                datatype: 'json',
                                data: AlinanOdemeData,
                                contentType: false,
                                processData: false,
                                url: "/Otomasyon/RezervasyonIslemleri/AlinanOdemeEkle/",
                                success: function (data) {
                                    if (data.Sonuc == false) {
                                        alertify.set('notifier', 'delay', 5);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.error(data.Mesaj);
                                    }
                                    else if (data.Sonuc == true) {
                                        alertify.set('notifier', 'delay', 3);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.success(data.Mesaj);
                                        odemetoplam = 0;
                                        var odemetutar = 0;
                                        $("#alinanodemeler-satir").empty();

                                        $.each(data.data, function (index, item_1) {
                                            odemetutar = item_1.Tutar;
                                            if (item_1.Iptal == true) { // Ödeme İptal edilmiş ise
                                                $("#alinanodemeler-satir").append("<tr class='bg-danger-50'>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal='" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                            else {
                                                odemetoplam = odemetoplam + parseFloat(odemetutar);
                                                $("#alinanodemeler-satir").append("<tr>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 makbuzyazdir' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='Makbuz Yazdır'>" +
                                                    "<i class='fal fa-print'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-success btn-icon mr-1 odemesmsgonder' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='SMS Gönder'>" +
                                                    "<i class='fal fa-mobile-alt'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-info btn-icon mr-1 odemeiptal' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='Ödemeyi İptal Et'>" +
                                                    "<i class='fal fa-times-circle'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal='" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                        });
                                        var kalantoplam = parseFloat(KalanOdemeToplam) - parseFloat(alacaktutar);

                                        $("#Odemetoplam").html(accounting.formatMoney(odemetoplam, "TL", 2, ".", ",", "%v %s"));
                                        $("#kalanodemetoplam").html(accounting.formatMoney(kalantoplam, "TL", 2, ".", ",", "%v %s"));
                                        $("#kalanodemetoplam2").html(accounting.formatMoney(kalantoplam, "TL", 2, ".", ",", "%v %s"));

                                        $("#gelecekodemeid-" + OdemeAlId).addClass("bg-primary-50"); // Borç tarafında ödemesi alınan satırın rengini değiştiriyor.
                                        $("#gelecekodemeid-" + OdemeAlId).find('a').addClass("disabled");
                                        OdemeAlDurum = false; // Ödeme durumu sıfırlanıyor.

                                        $("#OdemeTarihi").val(dateFormat(new Date()));
                                        $("#OdemeTutar").val("");
                                        $("#OdemeAciklama").val("");
                                        $("#OdemeSekli").val("1");
                                    }
                                },
                                error: function (err) {
                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                    alert("HATA");
                                }
                            });
                        }
                    }
                }
                else {  // Eğer Borçtan ödeme alınmıyor doğrudan girilen değerden ödeme alınıyorsa kalan bakiye kontrolü yapılacak
                    if (kalanbakiye == 0) {
                        Swal.fire(
                            {
                                title: "Borç Bitti",
                                html: "<p style='color:red'> Sözleşme tutarının tamamı ödendi!</p><p style='color:red'> Başka Ödeme Kalmadı!</p>",
                                type: "warning",
                                confirmButtonText: "Tamam"
                            });
                    }
                    else if (parseFloat(odemetutar) > parseFloat(kalanbakiye)) {
                        Swal.fire(
                            {
                                title: "Geçersiz Tutar",
                                html: "<p style='color:red'> Girdiğiniz tutar Sözleşme Kalan tutarından büyük olamaz!</p>",
                                type: "warning",
                                confirmButtonText: "Tamam"
                            });
                    }
                    else {
                        if ($("#OdemeTutar").val() == "0" || $("#OdemeTutar").val() == "") {
                            $("#OdemeTutar").focus();
                            $("#OdemeTutarHata").append("<div class='odemetutarhata' style='color:red'>Tutar 0(sıfır) olamaz.</div>");
                        }
                        else {
                            var AlinanOdemeData = new FormData();
                            AlinanOdemeData.append("SozlesmeId", sozlesmeId);
                            AlinanOdemeData.append("SozlesmeNo", sozlesmeNo);
                            AlinanOdemeData.append("OdemeAdSoyad", $("#AdSoyad").val());
                            AlinanOdemeData.append("MusteriId", musteriid);
                            AlinanOdemeData.append("OdemeAlDurum", OdemeAlDurum);
                            AlinanOdemeData.append("OdemeAlacakId", $("#OdemeTarihi").data("alacakid"));
                            AlinanOdemeData.append("OdemeTarihi", $("#OdemeTarihi").val());
                            AlinanOdemeData.append("OdemeTutar", $("#OdemeTutar").val().replace(" TL", ""));
                            AlinanOdemeData.append("OdemeSekli", $("#OdemeSekli").find("option:selected").text());
                            AlinanOdemeData.append("OdemeAciklama", $("#OdemeAciklama").val());
                            $.ajax({
                                type: "POST",
                                datatype: 'json',
                                data: AlinanOdemeData,
                                contentType: false,
                                processData: false,
                                url: "/Otomasyon/RezervasyonIslemleri/AlinanOdemeEkle/",
                                success: function (data) {
                                    if (data.Sonuc == false) {
                                        alertify.set('notifier', 'delay', 5);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.error(data.Mesaj);
                                    }
                                    else if (data.Sonuc == true) {
                                        alertify.set('notifier', 'delay', 3);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.success(data.Mesaj);
                                        odemetoplam = 0;
                                        var odemetutar = 0;
                                        $("#alinanodemeler-satir").empty();
                                        $.each(data.data, function (index, item_1) {
                                            odemetutar = item_1.Tutar;
                                            if (item_1.Iptal == true) { // Ödeme İptal edilmiş ise
                                                $("#alinanodemeler-satir").append("<tr class='bg-danger-50'>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal='" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                            else {
                                                odemetoplam = odemetoplam + parseFloat(odemetutar);
                                                $("#alinanodemeler-satir").append("<tr>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 makbuzyazdir' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='Makbuz Yazdır'>" +
                                                    "<i class='fal fa-print'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-success btn-icon mr-1 odemesmsgonder' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='SMS Gönder'>" +
                                                    "<i class='fal fa-mobile-alt'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-info btn-icon mr-1 odemeiptal' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='Ödemeyi İptal Et'>" +
                                                    "<i class='fal fa-times-circle'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal='" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                        });

                                        var odemetutar = $("#OdemeTutar").val();
                                        odemetutar = odemetutar.replace(" TL", "");
                                        odemetutar = odemetutar.replace(".", "");
                                        odemetutar = odemetutar.replace(",", ".");

                                        var kalanbakiye = parseFloat(SozlesmeKalan) - parseFloat(odemetutar);

                                        $("#Odemetoplam").html(accounting.formatMoney(odemetoplam, "TL", 2, ".", ",", "%v %s"));
                                        $("#sozlesmekalan").html(accounting.formatMoney(kalanbakiye, "TL", 2, ".", ",", "%v %s"));

                                        // Kalan ödeme tarafında
                                        if (OdemeAlDurum == false) {
                                            if (parseFloat(alacaktoplam) == 0) { // alacak girilmişse alacaktoplam değişkeni sıfır olacak
                                                $("#kalanalacak").html(accounting.formatMoney(kalanbakiye, "TL", 2, ".", ",", "%v %s")); // kalan alacak alanına yapılan ödemeler sonucunda kalan bakiye yazılacak.
                                            }
                                            else // eger bir alacak kaydı girildiyse alacaktoplam değeri yapılan ödemeler sonucunda kalan bakiyeden alacak toplam değeri çıkılarak kalan bakiye yazılacak.
                                            {
                                                var alacakkalan = parseFloat(kalanbakiye) - parseFloat(alacaktoplam);
                                                if (alacakkalan >= 0) {
                                                    $("#kalanalacak").html(accounting.formatMoney(alacakkalan, "TL", 2, ".", ",", "%v %s"));
                                                }
                                            }
                                        }
                                        else {
                                            $("#gelecekodemeid-" + OdemeAlId).addClass("bg-primary-50"); // Borç tarafında ödemesi alınan satırın rengini değiştiriyor.
                                            $("#gelecekodemeid-" + OdemeAlId).find('a').addClass("disabled");
                                            OdemeAlDurum == false; // Ödeme durumu sıfırlanıyor.
                                        }
                                        $("#OdemeTarihi").val(dateFormat(new Date()));
                                        $("#OdemeTutar").val("");
                                        $("#OdemeAciklama").val("");
                                        $("#OdemeSekli").val("1");
                                    }
                                },
                                error: function (err) {
                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                    alert("HATA");
                                }
                            });
                        }
                    }
                }
            });
            $("#tb-alinanodemeler").on('click', '.odemeiptal', function () {
                var id = $(this).data("odemeid");
                var odemelergelecekid = $(this).data("odemelergelecekid");
                var tarih = $(this).data("odemetarih");
                var tutar = $(this).data("odemetutar");
                Swal.fire(
                    {
                        title: "Ödeme İptal",
                        html: "<p style='color:red;font-weight:bold;font-size:12pt;'>&laquo; " + tarih + " - " + tutar + " &raquo;</p> <p style='color:red;font-size:12pt;'><h3> Ödeme iptal edilsin mi?</h3></p> ",
                        type: "error",
                        showCancelButton: true,
                        confirmButtonText: "Evet, İptal Et!",
                        cancelButtonText: "Vazgeç"
                    }).then(function (result) {
                        if (result.value) {
                            var AlinanOdemeData = new FormData();
                            AlinanOdemeData.append("Id", id);
                            AlinanOdemeData.append("OdemelerGelecekId", odemelergelecekid);
                            $.ajax({
                                type: "POST",
                                datatype: 'json',
                                data: AlinanOdemeData,
                                contentType: false,
                                processData: false,
                                url: "/Otomasyon/RezervasyonIslemleri/AlinanOdemeIptal/" + id,
                                success: function (data) {
                                    if (data.Sonuc == false) {
                                        alertify.set('notifier', 'delay', 5);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.error(data.Mesaj);
                                    }
                                    else if (data.Sonuc == true) {
                                        alertify.set('notifier', 'delay', 3);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.success(data.Mesaj);
                                        var odemetoplam = $("#Odemetoplam").html(); // yapılmış ödemeler toplamının yazıldığı alandan bu değeri okuyorum.
                                        odemetoplam = odemetoplam.replace(" TL", "");
                                        odemetoplam = odemetoplam.replace(".", "");
                                        odemetoplam = odemetoplam.replace(",", ".");
                                        var iptaltutar = 0; // iptal edilen tutar
                                        iptaltutar = tutar.replace(" TL", "");
                                        iptaltutar = iptaltutar.replace(".", "");
                                        iptaltutar = iptaltutar.replace(",", ".");
                                        $("#alinanodemeler-satir").empty();
                                        odemetoplam = odemetoplam - parseFloat(iptaltutar); // toplam ödeme tutarından iptal edilen tutardüşülüyor.
                                        $.each(data.data, function (index, item_1) {
                                            if (item_1.Iptal == true) {
                                                $("#alinanodemeler-satir").append("<tr class='bg-danger-50'>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal'" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                            else {
                                                $("#alinanodemeler-satir").append("<tr>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 makbuzyazdir' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "'title='Makbuz Yazdır'>" +
                                                    "<i class='fal fa-print'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-success btn-icon mr-1 odemesmsgonder' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='SMS Gönder'>" +
                                                    "<i class='fal fa-mobile-alt'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-info btn-icon mr-1 odemeiptal' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='Ödemeyi İptal Et'>" +
                                                    "<i class='fal fa-times-circle'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal'" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                        });

                                        var sozlesmekalan = $("#sozlesmekalan").html();
                                        sozlesmekalan = sozlesmekalan.replace(" TL", "");
                                        sozlesmekalan = sozlesmekalan.replace(".", "");
                                        sozlesmekalan = sozlesmekalan.replace(",", ".");

                                        var kalanbakiye = parseFloat(ToplamTutar) - parseFloat(odemetoplam); // İptal sonucu kalan bakiye gündelleniyor.
                                        $("#Odemetoplam").html(accounting.formatMoney(odemetoplam, "TL", 2, ".", ",", "%v %s"));
                                        $("#sozlesmekalan").html(accounting.formatMoney(kalanbakiye, "TL", 2, ".", ",", "%v %s"));

                                        if (odemelergelecekid != 0) {
                                            $("#gelecekodemeid-" + odemelergelecekid).removeClass("bg-primary-50"); //Alınan ödeme iptal edildiğinde Borç tarafında ödemesi alınan satır eski haline getiriliyor.
                                            $("#gelecekodemeid-" + odemelergelecekid).find('a').removeClass("disabled");

                                            kalanbakiye = parseFloat(sozlesmekalan); // İptal sonucu kalan bakiye gündelleniyor.
                                            $("#sozlesmekalan").html(accounting.formatMoney(kalanbakiye, "TL", 2, ".", ",", "%v %s"));

                                            var KalanOdemeToplam = $("#kalanodemetoplam").html();
                                            KalanOdemeToplam = KalanOdemeToplam.replace(" TL", "");
                                            KalanOdemeToplam = KalanOdemeToplam.replace(".", "");
                                            KalanOdemeToplam = KalanOdemeToplam.replace(",", ".");

                                            var kalanodemelertoplam = parseFloat(KalanOdemeToplam) + parseFloat(iptaltutar)
                                            $("#kalanodemetoplam").html(accounting.formatMoney(kalanodemelertoplam, "TL", 2, ".", ",", "%v %s"));
                                            $("#kalanodemetoplam2").html(accounting.formatMoney(kalanodemelertoplam, "TL", 2, ".", ",", "%v %s"));
                                        }
                                        else {
                                            kalanbakiye = parseFloat(sozlesmekalan) + parseFloat(iptaltutar); // İptal sonucu kalan bakiye gündelleniyor.
                                            $("#sozlesmekalan").html(accounting.formatMoney(kalanbakiye, "TL", 2, ".", ",", "%v %s"));
                                        }
                                    }
                                },
                                error: function (err) {
                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                    alert("HATA");
                                }
                            });
                        }
                    });
            }); // Alınan Ödeme İptal
            $("#tb-alinanodemeler").on('click', '.odemesil', function () {
                var id = $(this).data("odemeid");
                var tarih = $(this).data("odemetarih");
                var tutar = $(this).data("odemetutar");
                var iptal = $(this).data("iptal");
                $("#SilinenTutar").val($(this).data("odemetutar"));
                var odemelergelecekid = $(this).data("odemelergelecekid");
                Swal.fire(
                    {
                        title: "Ödeme Sil",
                        html: "<p style='color:red;font-weight:bold;font-size:12pt;'>&laquo; " + tarih + " - " + tutar + " &raquo;</p> <p style='color:red;font-size:12pt;'><h3> Ödeme silinsin mi?</h3></p> ",
                        type: "error",
                        showCancelButton: true,
                        confirmButtonText: "Sil!"
                    }).then(function (result) {
                        if (result.value) {
                            $.ajax({
                                type: "POST",
                                datatype: 'json',
                                contentType: false,
                                processData: false,
                                url: "/Otomasyon/RezervasyonIslemleri/AlinanOdemeSil/" + id,
                                success: function (data) {
                                    if (data.Sonuc == false) {
                                        alertify.set('notifier', 'delay', 5);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.error(data.Mesaj);
                                    }
                                    else if (data.Sonuc == true) {
                                        alertify.set('notifier', 'delay', 3);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.success(data.Mesaj);
                                        var odemetoplam = 0;
                                        var odemetutar = 0;
                                        $("#alinanodemeler-satir").empty();
                                        $.each(data.data, function (index, item_1) {
                                            odemetutar = item_1.Tutar;
                                            if (item_1.Iptal == true) {
                                                $("#alinanodemeler-satir").append("<tr class='bg-danger-50'>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal'" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                            else {
                                                odemetoplam = odemetoplam + parseFloat(odemetutar);
                                                $("#alinanodemeler-satir").append("<tr>" +
                                                    "<td class='text-center'>" + item_1.Tarih + "</td>" +
                                                    "<td class='text-right'>" + ParaFormat(item_1.Tutar) + "</td>" +
                                                    "<td class='text-center'>" + item_1.Aciklama + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 makbuzyazdir' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='Makbuz Yazdır'>" +
                                                    "<i class='fal fa-print'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-success btn-icon mr-1 odemesmsgonder' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='SMS Gönder'>" +
                                                    "<i class='fal fa-mobile-alt'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-info btn-icon mr-1 odemeiptal' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' title='Ödemeyi İptal Et'>" +
                                                    "<i class='fal fa-times-circle'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 odemesil' data-odemelergelecekid='" + item_1.OdemelerGelecekId + "' data-odemeid='" + item_1.Id + "' data-odemetarih='" + item_1.Tarih + "' data-odemetutar='" + ParaFormat(item_1.Tutar) + "' data-iptal'" + item_1.Iptal + "' title='Ödemeyi Sil'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                        });
                                        if (iptal == true) { // Silinmek istenen iptal edilmiş satır ise bakiyelerde güncelleme olmayacak

                                        }
                                        else {
                                            $("#Odemetoplam").html(accounting.formatMoney(odemetoplam, "TL", 2, ".", ",", "%v %s"));

                                            var sozlesmekalan = $("#sozlesmekalan").html();
                                            sozlesmekalan = sozlesmekalan.replace(" TL", "");
                                            sozlesmekalan = sozlesmekalan.replace(".", "");
                                            sozlesmekalan = sozlesmekalan.replace(",", ".");

                                            var silinentutar = $("#SilinenTutar").val();
                                            silinentutar = silinentutar.replace(" TL", "");
                                            silinentutar = silinentutar.replace(".", "");
                                            silinentutar = silinentutar.replace(",", ".");

                                            if (parseFloat(odemelergelecekid) != 0) {
                                                $("#gelecekodemeid-" + odemelergelecekid).removeClass("bg-primary-50"); //Alınan ödeme silindiğinde Borç tarafında ödemesi alınan satır eski haline getiriliyor.
                                                $("#gelecekodemeid-" + odemelergelecekid).find('a').removeClass("disabled");

                                                kalanbakiye = parseFloat(sozlesmekalan); // İptal sonucu kalan bakiye gündelleniyor.
                                                $("#sozlesmekalan").html(accounting.formatMoney(kalanbakiye, "TL", 2, ".", ",", "%v %s"));

                                                var KalanOdemeToplam = $("#kalanodemetoplam").html();
                                                KalanOdemeToplam = KalanOdemeToplam.replace(" TL", "");
                                                KalanOdemeToplam = KalanOdemeToplam.replace(".", "");
                                                KalanOdemeToplam = KalanOdemeToplam.replace(",", ".");

                                                var kalanodemelertoplam = parseFloat(KalanOdemeToplam) + parseFloat(silinentutar)
                                                $("#kalanodemetoplam").html(accounting.formatMoney(kalanodemelertoplam, "TL", 2, ".", ",", "%v %s"));
                                                $("#kalanodemetoplam2").html(accounting.formatMoney(kalanodemelertoplam, "TL", 2, ".", ",", "%v %s"));
                                            }
                                            else {
                                                kalanbakiye = parseFloat(sozlesmekalan) + parseFloat(silinentutar); // İptal sonucu kalan bakiye gündelleniyor.
                                                $("#sozlesmekalan").html(accounting.formatMoney(parseFloat(kalanbakiye), "TL", 2, ".", ",", "%v %s")); // parseFloat(kalanbakiye) kullanmadan yanlış değer veriyor.
                                            }
                                        }
                                    }
                                },
                                error: function (err) {
                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                    alert("HATA");
                                }
                            });
                        }
                    });
            }); // Alınan Ödeme Sil
            $("#tb-alinanodemeler").on('click', '.makbuzyazdir', function () {
                var id = $(this).data("odemeid");
                window.open("/Otomasyon/RezervasyonIslemleri/AlinanOdemeMakbuzYazdir/" + id, '_blank');
            }); // Ödeme Makbuzu Yazdır
            $("#tb-alinanodemeler").on('click', '.odemesmsgonder', function () {
                var id = $(this).data("odemeid");
                $.ajax({
                    type: "POST",
                    datatype: 'json',
                    //data: SMSGonderData,
                    contentType: false,
                    processData: false,
                    url: "/Otomasyon/RezervasyonIslemleri/AlinanOdemeSMSAyarKotrol/",
                    success: function (data) {
                        if (data.Sonuc == false) {
                            Swal.fire(
                                {
                                    title: "Bilgi SMS'i Gönder",
                                    //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                                    html: "<p style='color:red;font-size:12pt;'><h3> " + data.Mesaj + " </h3></p> ",
                                    type: "warning",
                                    showCancelButton: false,
                                    confirmButtonText: "Tamam!"
                                })
                        }
                        else if (data.Sonuc == true) {
                            Swal.fire(
                                {
                                    title: "Bilgi SMS'i Gönder",
                                    //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                                    html: "<p style='color:red;font-size:12pt;'><h3> Müşteriye Ödeme bilgi SMS'i gönderilsin mi?</h3></p> ",
                                    type: "warning",
                                    showCancelButton: true,
                                    confirmButtonText: "Gönder!"
                                }).then(function (result) {
                                    if (result.value) {

                                        var SMSGonderData = new FormData();
                                        SMSGonderData.append("MusteriId", musteriid);
                                        SMSGonderData.append("SozlesmeId", sozlesmeId);
                                        SMSGonderData.append("OdemeId", id);
                                        $.ajax({
                                            type: "POST",
                                            datatype: 'json',
                                            data: SMSGonderData,
                                            contentType: false,
                                            processData: false,
                                            beforeSend: function () {
                                                Swal.fire(
                                                    {
                                                        title: "Müşteriye Bilgi SMS'i Gönderiliyor!",
                                                        html: "<strong>Lütfen Bekleyin.</strong>",
                                                        onBeforeOpen: function onBeforeOpen() {
                                                            Swal.showLoading();
                                                        }
                                                    });
                                            },
                                            url: "/Otomasyon/RezervasyonIslemleri/AlinanOdemeSMSGonder/",
                                            success: function (data) {
                                                if (data.Sonuc == false) {
                                                    alertify.set('notifier', 'delay', 5);
                                                    alertify.set('notifier', 'position', 'top-center');
                                                    alertify.error(data.Mesaj);
                                                    swal.close();
                                                }
                                                else if (data.Sonuc == true) {
                                                    alertify.set('notifier', 'delay', 3);
                                                    alertify.set('notifier', 'position', 'top-center');
                                                    alertify.success(data.Mesaj);
                                                    swal.close();
                                                }
                                            },
                                            error: function (err) {
                                                alert("HATA");
                                            }
                                        });
                                    }
                                });
                        }
                    },
                    error: function (err) {
                        alert("HATA");
                    }
                });
            }); // Çekim Randevusu Bilgi SMS i gönder

            // ------ Alınan ve Gelecek Ödeme Ekleme/Silme İşlemleri
            // ------ Çekim Randevusu Ekleme/Silme İşlemleri

            // Randevu ekleme sekmesindeki personel seçim işlemi
            var RandevuPersonelListesi = $("#PersonelListesi :checkbox");
            RandevuPersonelListesi.on("change", function () {
                SecilenRandevuPersonel();
            });
            function SecilenRandevuPersonel() {
                while (RandevuPersonelIdArray.length > 0) {
                    RandevuPersonelIdArray.pop();
                }
                RandevuPersonelListesi.filter(":checked").each(function () {
                    var persid = $(this).data("spersid").replace("cekim-", "");
                    console.log(persid);
                    RandevuPersonelIdArray.push($(this).data("spersid").replace("cekim-", ""));
                });
                //console.log(RandevuPersonelIdArray);
            }

            // Sozlesme sekmesindeki personel seçim işlemi
            var SozlesmePersonelListesi = $("#SozlesmePersonelListesi :checkbox");
            SozlesmePersonelListesi.on("change", function () {
                SecilenSozlesmePersonel();
            });
            function SecilenSozlesmePersonel() {
                while (SozlesmePersonelIdArray.length > 0) {
                    SozlesmePersonelIdArray.pop();
                }
                SozlesmePersonelListesi.filter(":checked").each(function () {
                    SozlesmePersonelIdArray.push($(this).data("persid"));
                });
                //console.log(SozlesmePersonelIdArray);
            }

            $("#CekimEkle").click(function () {
                console.log(RandevuPersonelIdArray);
                if (($("#CekimBaslangic").val() == $("#CekimBitis").val())) {
                    $("#CekimBaslangic").focus();
                    $("#CekimZamanHata").append("<div class='hata' style='color:red'>Başlangıç ve Bitiş zamanları aynı olamaz.</div>");
                }
                else if (($("#CekimYeri").val() == "")) {
                    $("#CekimYeri").focus();
                    $("#CekimYeriHata").append("<div class='hata' style='color:red'>Çekim yapılacak yeri yazınız.</div>");
                }
                else if (RandevuPersonelIdArray.length == 0) {
                    $("#CekimPersonelIdHata").append("<div id='PersonelHata' style='color:red'>Lütfen bir personel seçiniz.</div>");
                }
                else {
                    var rezervasyontarih = $("#CekimTarihi").val();
                    var TatilKontrolData = new FormData();
                    TatilKontrolData.append("RezervasyonTarihi", $("#CekimTarihi").val());
                    $.ajax({
                        type: "POST",
                        datatype: 'json',
                        data: TatilKontrolData,
                        contentType: false,
                        processData: false,
                        url: "/Otomasyon/RezervasyonIslemleri/TatilKotrol/",
                        success: function (data) {
                            if (data.Sonuc == false) {
                                Swal.fire(
                                    {
                                        title: "Dikkat",
                                        html: "<p><h2 style='font-size:16px; color:red'><strong>Rezervasyon Tarihi : </strong>" + rezervasyontarih + "</h2></p><h4> " + data.Mesaj + "</h4>",
                                        type: "warning",
                                        confirmButtonText: "Tamam"
                                    });
                                //sonuctatilkontrolcekim = "çalışamaz";
                            }
                            else if (data.Sonuc == true) {
                                //sonuctatilkontrolcekim = "çalışabilir";
                                var PersonelId = $("#CekimPersonelId").find("option:selected").val();
                                var Personel = $("#CekimPersonelId").find("option:selected").text();
                                var PersonelData = new FormData();
                                PersonelData.append("RezervasyonTarihi", $("#CekimTarihi").val());
                                PersonelData.append("PersonelIdArray", RandevuPersonelIdArray);
                                $.ajax({
                                    type: "POST",
                                    datatype: 'json',
                                    data: PersonelData,
                                    contentType: false,
                                    processData: false,
                                    url: "/Otomasyon/RezervasyonIslemleri/PersonelIzinKontrol/",
                                    success: function (data) {
                                        if (data.Sonuc == false) {  //sonucizinkontrol = "çalışamaz";
                                            var personelAdi = "";
                                            $.each(data.CalisamazPersonel, function (index, pers) {
                                                personelAdi = personelAdi + pers.AdiSoyadi + "<br/>";
                                            });
                                            Swal.fire(
                                                {
                                                    title: "Dikkat",
                                                    html: "<p><h4 style='font-size:16px; color:red'> Aşağıdaki Personel(ler) rezervasyon tarihinde izinliler</h4></p> <p><h2> <strong> " + personelAdi + " </strong><h2> </p>",
                                                    type: "warning",
                                                    confirmButtonText: "Tamam"
                                                });
                                        }
                                        else if (data.Sonuc == true) {
                                            //sonucizinkontrolcekim = "çalışabilir";
                                            //var PersonelId = $("#CekimPersonelId").find("option:selected").val();
                                            var ZamanDilimiId = 0
                                            //var Personel = $("#CekimPersonelId").find("option:selected").text();
                                            var BaslangicSaati = $("#CekimBaslangic").val();
                                            var BitisSaati = $("#CekimBitis").val();
                                            var Tarih = $("#CekimTarihi").val();
                                            var GorevlendirmeKontrolData = new FormData();
                                            GorevlendirmeKontrolData.append("RezervasyonTarihi", $("#CekimTarihi").val());
                                            GorevlendirmeKontrolData.append("PersonelIdArray", RandevuPersonelIdArray);
                                            GorevlendirmeKontrolData.append("ZamanDilimiId", ZamanDilimiId);
                                            GorevlendirmeKontrolData.append("BaslangicSaati", BaslangicSaati);
                                            GorevlendirmeKontrolData.append("BitisSaati", BitisSaati);
                                            $.ajax({
                                                type: "POST",
                                                datatype: 'json',
                                                data: GorevlendirmeKontrolData,
                                                contentType: false,
                                                processData: false,
                                                url: "/Otomasyon/RezervasyonIslemleri/GorevlendirmeKontrol/",
                                                success: function (data) {
                                                    if (data.Sonuc == false) {
                                                        var personelAdi = "";
                                                        $.each(data.CalisamazPersonel, function (index, pers) {
                                                            personelAdi = personelAdi + pers.AdiSoyadi + "<br/>";
                                                        });
                                                        Swal.fire(
                                                            {
                                                                title: "Dikkat",
                                                                html: "<p><h4 style='font-size:16px; color:red'> Aşağıdaki Personel(ler) rezervasyon tarihinde başka bir randevu için görevlendirilmiş.</h4></p> <p><h2> <strong> " + personelAdi + " </strong><h2> </p>",
                                                                type: "warning",
                                                                confirmButtonText: "Tamam"
                                                            });
                                                    }
                                                    else if (data.Sonuc == true) {
                                                        //sonucgorevlendirmekontrolcekim = "çalışabilir";
                                                        var CekimData = new FormData();
                                                        CekimData.append("SozlesmeId", sozlesmeId);
                                                        CekimData.append("SozlesmeNo", sozlesmeNo);
                                                        CekimData.append("MusteriId", musteriid);
                                                        CekimData.append("RezervasyonTurId", $("#RezervasyonTurId").val());
                                                        CekimData.append("PersonelIdArray", RandevuPersonelIdArray);
                                                        CekimData.append("CekimTarihi", $("#CekimTarihi").val());
                                                        CekimData.append("CekimBaslangic", $("#CekimBaslangic").val());
                                                        CekimData.append("CekimBitis", $("#CekimBitis").val());
                                                        CekimData.append("CekimYeri", $("#CekimYeri").val());
                                                        $.ajax({
                                                            type: "POST",
                                                            datatype: 'json',
                                                            data: CekimData,
                                                            contentType: false,
                                                            processData: false,
                                                            url: "/Otomasyon/RezervasyonIslemleri/CekimRandevuEkle/",
                                                            success: function (data) {
                                                                if (data.Sonuc == false) {
                                                                    alertify.set('notifier', 'delay', 5);
                                                                    alertify.set('notifier', 'position', 'top-center');
                                                                    alertify.error(data.Mesaj);
                                                                }
                                                                else if (data.Sonuc == true) {
                                                                    alertify.set('notifier', 'delay', 3);
                                                                    alertify.set('notifier', 'position', 'top-center');
                                                                    alertify.success(data.Mesaj);
                                                                    $("#cekimrandevu-satir").empty();
                                                                    var GorevliPersoneller = "";
                                                                    $.each(data.PersonelList, function (index, item_1) {
                                                                        GorevliPersoneller = GorevliPersoneller + item_1.PersonelAdiSoyadi + " - " + item_1.PersonelGorevi + "<br/>";
                                                                    });
                                                                    $.each(data.data, function (index, item_1) {
                                                                        var t = item_1.Tarih;
                                                                        var tarih = dateFormat(new Date(parseInt(t.match(/\d+/)[0])));
                                                                        var bs = item_1.Baslangic;
                                                                        var bt = item_1.Bitis;
                                                                        var bs1 = timeFormat(new Date(parseInt(bs.match(/\d+/)[0])));
                                                                        var bt1 = timeFormat(new Date(parseInt(bt.match(/\d+/)[0])));
                                                                        if (item_1.Iptal == true) {
                                                                            $("#cekimrandevu-satir").append("<tr class='bg-danger-50'>" +
                                                                                "<td>" + tarih + "</td>" +
                                                                                //"<td>" + baslangicsaat + ":" + baslangicdakika + " - " + bitissaat + ":" + bitisdakika + "</td>" +
                                                                                "<td>" + bs1 + " - " + bt1 + "</td>" +
                                                                                "<td>" + item_1.Aciklama + "</td>" +
                                                                                "<td>" + GorevliPersoneller + "</td>" +
                                                                                "<td class='text-center'>" +
                                                                                //"<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 cekimranduevusms' title='Bilgilendirme SMS'i Gönder' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                                                //    "<i class='fal fa-mobile-alt'></i>" +
                                                                                //"</a>" +
                                                                                //"<a href='#' class='btn btn-xs btn-info btn-icon mr-1 disabled cekimranduevuiptal' title='Randevuyu İptal Et' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                                                //   "<i class='fal fa-times-circle'></i>" +
                                                                                //"</a>" +
                                                                                "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 cekimranduevusil' title='Randevuyu Sil' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                                                "<i class='fal fa-trash-alt'></i>" +
                                                                                "</a>" +
                                                                                "</td>" +
                                                                                "</tr>");
                                                                        }
                                                                        else {
                                                                            $("#cekimrandevu-satir").append("<tr>" +
                                                                                "<td>" + tarih + "</td>" +
                                                                                //"<td>" + baslangicsaat + ":" + baslangicdakika + " - " + bitissaat + ":" + bitisdakika + "</td>" +
                                                                                "<td>" + bs1 + " - " + bt1 + "</td>" +
                                                                                "<td>" + item_1.Aciklama + "</td>" +
                                                                                "<td>" + GorevliPersoneller + "</td>" +
                                                                                "<td class='text-center'>" +
                                                                                "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 cekimranduevusms' title='Bilgilendirme SMS'i Gönder' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                                                "<i class='fal fa-mobile-alt'></i>" +
                                                                                "</a>" +
                                                                                "<a href='#' class='btn btn-xs btn-info btn-icon mr-1 cekimranduevuiptal' title='Randevuyu İptal Et' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                                                "<i class='fal fa-times-circle'></i>" +
                                                                                "</a>" +
                                                                                "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 cekimranduevusil' title='Randevuyu Sil' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                                                "<i class='fal fa-trash-alt'></i>" +
                                                                                "</a>" +
                                                                                "</td>" +
                                                                                "</tr>");
                                                                        }
                                                                        //});
                                                                    });
                                                                }
                                                                $("#CekimTarihi").datepicker("setDate", new Date());
                                                                $("#CekimBaslangic").val("00:00");
                                                                $("#CekimBitis").val("00:00");
                                                                $("#CekimYeri").val("");
                                                                var RandevuPersonelListesi = $("#PersonelListesi :checkbox");
                                                                RandevuPersonelListesi.prop("checked", false);
                                                            },
                                                            error: function (err) {
                                                                alert("HATA");
                                                            }
                                                        });
                                                    }
                                                },
                                                error: function (err) {
                                                    alert("HATA");
                                                }
                                            });
                                        }
                                    },
                                    error: function (err) {
                                        alert("HATA");
                                    }
                                });
                            }
                        },
                        error: function (err) {
                            alert("HATA");
                        }
                    });
                }
            });
            $("#tb-cekimrandeulari").on('click', '.cekimranduevuiptal', function () {
                var id = $(this).data("cekimid");
                var t = $(this).data("cekimtarih");
                var bt = $(this).data("cekimbaslama");
                var bit = $(this).data("cekimbitis");
                var tarih = dateFormat(new Date(parseInt(t.match(/\d+/)[0])));
                var baslangic = timeFormat(new Date(parseInt(bt.match(/\d+/)[0])));
                var bitis = timeFormat(new Date(parseInt(bit.match(/\d+/)[0])));
                Swal.fire(
                    {
                        title: "Randevu İptal",
                        //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                        html: "<p style='color:red;font-weight:bold;font-size:12pt;'>&laquo; " + tarih + " - " + baslangic + "-" + bitis + " &raquo;</p> <p style='color:red;font-size:12pt;'><h3> Çekim Randevusunu iptal edilsin mi?</h3></p> ",
                        type: "error",
                        showCancelButton: true,
                        confirmButtonText: "Evet, İptal Et!",
                        cancelButtonText: "İptal"
                    }).then(function (result) {
                        if (result.value) {
                            $.ajax({
                                type: "POST",
                                datatype: 'json',
                                contentType: false,
                                processData: false,
                                url: "/Otomasyon/RezervasyonIslemleri/CekimRandevuIptal/" + id,
                                success: function (data) {
                                    if (data.Sonuc == false) {
                                        alertify.set('notifier', 'delay', 5);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.error(data.Mesaj);
                                    }
                                    else if (data.Sonuc == true) {
                                        alertify.set('notifier', 'delay', 3);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.success(data.Mesaj);
                                        $("#cekimrandevu-satir").empty();
                                        var GorevliPersoneller = "";
                                        $.each(data.PersonelList, function (index, item_1) {
                                            GorevliPersoneller = GorevliPersoneller + item_1.PersonelAdiSoyadi + " - " + item_1.PersonelGorevi + "<br/>";
                                        });
                                        $.each(data.data, function (index, item_1) {
                                            var t = item_1.Tarih;
                                            var tarih = dateFormat(new Date(parseInt(t.match(/\d+/)[0])));
                                            var bs = item_1.Baslangic;
                                            var bt = item_1.Bitis;
                                            var bs1 = timeFormat(new Date(parseInt(bs.match(/\d+/)[0])));
                                            var bt1 = timeFormat(new Date(parseInt(bt.match(/\d+/)[0])));
                                            if (item_1.Iptal == true) {
                                                $("#cekimrandevu-satir").append("<tr class='bg-danger-50'>" +
                                                    "<td>" + tarih + "</td>" +
                                                    //"<td>" + baslangicsaat + ":" + baslangicdakika + " - " + bitissaat + ":" + bitisdakika + "</td>" +
                                                    "<td>" + bs1 + " - " + bt1 + "</td>" +
                                                    "<td>" + item_1.Aciklama + "</td>" +
                                                    "<td>" + GorevliPersoneller + "</td>" +
                                                    "<td class='text-center'>" +
                                                    //"<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 cekimranduevusms' title='Bilgilendirme SMS'i Gönder' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    //    "<i class='fal fa-mobile-alt'></i>" +
                                                    //"</a>" +
                                                    //"<a href='#' class='btn btn-xs btn-info btn-icon mr-1 disabled cekimranduevuiptal' title='Randevuyu İptal Et' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    //   "<i class='fal fa-times-circle'></i>" +
                                                    //"</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 cekimranduevusil' title='Randevuyu Sil' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                            else {
                                                $("#cekimrandevu-satir").append("<tr>" +
                                                    "<td>" + tarih + "</td>" +
                                                    //"<td>" + baslangicsaat + ":" + baslangicdakika + " - " + bitissaat + ":" + bitisdakika + "</td>" +
                                                    "<td>" + bs1 + " - " + bt1 + "</td>" +
                                                    "<td>" + item_1.Aciklama + "</td>" +
                                                    "<td>" + GorevliPersoneller + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 cekimranduevusms' title='Bilgilendirme SMS'i Gönder' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-mobile-alt'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-info btn-icon mr-1 cekimranduevuiptal' title='Randevuyu İptal Et' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-times-circle'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 cekimranduevusil' title='Randevuyu Sil' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                        });
                                    }
                                },
                                error: function (err) {
                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                    alert("HATA");
                                }
                            });
                        }
                    });
            }); // Çekim Randevusu İptal
            $("#tb-cekimrandeulari").on('click', '.cekimranduevusil', function () {
                var id = $(this).data("cekimid");
                var t = $(this).data("cekimtarih");
                var bt = $(this).data("cekimbaslama");
                var bit = $(this).data("cekimbitis");
                var tarih = dateFormat(new Date(parseInt(t.match(/\d+/)[0])));
                var baslangic = timeFormat(new Date(parseInt(bt.match(/\d+/)[0])));
                var bitis = timeFormat(new Date(parseInt(bit.match(/\d+/)[0])));
                Swal.fire(
                    {
                        title: "Randevu İptal",
                        //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                        html: "<p style='color:red;font-weight:bold;font-size:12pt;'>&laquo; " + tarih + " - " + baslangic + "-" + bitis + " &raquo;</p> <p style='color:red;font-size:12pt;'><h3> Çekim Randevusunu Silinsin mi?</h3></p> ",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonText: "Sil!",
                        cancelButtonText: "İptal"
                    }).then(function (result) {
                        if (result.value) {
                            $.ajax({
                                type: "POST",
                                datatype: 'json',
                                contentType: false,
                                processData: false,
                                url: "/Otomasyon/RezervasyonIslemleri/CekimRandevuSil/" + id,
                                success: function (data) {
                                    if (data.Sonuc == false) {
                                        alertify.set('notifier', 'delay', 5);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.error(data.Mesaj);
                                    }
                                    else if (data.Sonuc == true) {
                                        alertify.set('notifier', 'delay', 3);
                                        alertify.set('notifier', 'position', 'top-center');
                                        alertify.success(data.Mesaj);
                                        $("#cekimrandevu-satir").empty();
                                        var GorevliPersoneller = "";
                                        $.each(data.PersonelList, function (index, item_1) {
                                            GorevliPersoneller = GorevliPersoneller + item_1.PersonelAdiSoyadi + " - " + item_1.PersonelGorevi + "<br/>";
                                        });
                                        $.each(data.data, function (index, item_1) {
                                            var t = item_1.Tarih;
                                            var tarih = dateFormat(new Date(parseInt(t.match(/\d+/)[0])));
                                            var bs = item_1.Baslangic;
                                            var bt = item_1.Bitis;
                                            var bs1 = timeFormat(new Date(parseInt(bs.match(/\d+/)[0])));
                                            var bt1 = timeFormat(new Date(parseInt(bt.match(/\d+/)[0])));
                                            if (item_1.Iptal == true) {
                                                $("#cekimrandevu-satir").append("<tr class='bg-danger-50'>" +
                                                    "<td>" + tarih + "</td>" +
                                                    //"<td>" + baslangicsaat + ":" + baslangicdakika + " - " + bitissaat + ":" + bitisdakika + "</td>" +
                                                    "<td>" + bs1 + " - " + bt1 + "</td>" +
                                                    "<td>" + item_1.Aciklama + "</td>" +
                                                    "<td>" + GorevliPersoneller + "</td>" +
                                                    "<td class='text-center'>" +
                                                    //"<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 cekimranduevusms' title='Bilgilendirme SMS'i Gönder' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    //    "<i class='fal fa-mobile-alt'></i>" +
                                                    //"</a>" +
                                                    //"<a href='#' class='btn btn-xs btn-info btn-icon mr-1 disabled cekimranduevuiptal' title='Randevuyu İptal Et' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    //   "<i class='fal fa-times-circle'></i>" +
                                                    //"</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 cekimranduevusil' title='Randevuyu Sil' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                            else {
                                                $("#cekimrandevu-satir").append("<tr>" +
                                                    "<td>" + tarih + "</td>" +
                                                    //"<td>" + baslangicsaat + ":" + baslangicdakika + " - " + bitissaat + ":" + bitisdakika + "</td>" +
                                                    "<td>" + bs1 + " - " + bt1 + "</td>" +
                                                    "<td>" + item_1.Aciklama + "</td>" +
                                                    "<td>" + GorevliPersoneller + "</td>" +
                                                    "<td class='text-center'>" +
                                                    "<a href='#' class='btn btn-xs btn-primary btn-icon mr-1 cekimranduevusms' title='Bilgilendirme SMS'i Gönder' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-mobile-alt'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-info btn-icon mr-1 cekimranduevuiptal' title='Randevuyu İptal Et' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-times-circle'></i>" +
                                                    "</a>" +
                                                    "<a href='#' class='btn btn-xs btn-danger btn-icon mr-1 cekimranduevusil' title='Randevuyu Sil' data-cekimid='" + item_1.Id + "' data-cekimtarih='" + item_1.Tarih + "' data-cekimbaslama='" + item_1.Baslangic + "' data-cekimbitis='" + item_1.Bitis + "'>" +
                                                    "<i class='fal fa-trash-alt'></i>" +
                                                    "</a>" +
                                                    "</td>" +
                                                    "</tr>");
                                            }
                                        });
                                    }
                                },
                                error: function (err) {
                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                    alert("HATA");
                                }
                            });
                        }
                    });
            }); // Çekim Randevusu Sil
            $("#tb-cekimrandeulari").on('click', '.cekimranduevusms', function () {
                var id = $(this).data("cekimid");
                var PersonelId = $("#PersonelId").find("option:selected").val();
                $.ajax({
                    type: "POST",
                    datatype: 'json',
                    //data: SMSGonderData,
                    contentType: false,
                    processData: false,
                    url: "/Otomasyon/RezervasyonIslemleri/CekimRandevuSMSAyarKotrol/",
                    success: function (data) {
                        if (data.Sonuc == false) {
                            Swal.fire(
                                {
                                    title: "Bilgi SMS'i Gönder",
                                    //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                                    html: "<p style='color:red;font-size:12pt;'><h3> " + data.Mesaj + " </h3></p> ",
                                    type: "warning",
                                    showCancelButton: false,
                                    confirmButtonText: "Tamam!"
                                })
                        }
                        else if (data.Sonuc == true) {
                            Swal.fire(
                                {
                                    title: "Bilgi SMS'i Gönder",
                                    //text: "< " + giskategori + " > adlı Günlük İş Katergorisi silinsin mi?",
                                    html: "<p style='color:red;font-size:12pt;'><h3> Müşteriye randevu bilgi SMS'i gönderilsin mi?</h3></p> ",
                                    type: "warning",
                                    showCancelButton: true,
                                    confirmButtonText: "Gönder!"
                                }).then(function (result) {
                                    if (result.value) {
                                        var SMSGonderData = new FormData();
                                        SMSGonderData.append("MusteriId", musteriid);
                                        SMSGonderData.append("SozlesmeId", sozlesmeId);
                                        SMSGonderData.append("SozlesmeNo", sozlesmeNo);
                                        SMSGonderData.append("PersonelId", PersonelId);
                                        SMSGonderData.append("RandevuId", id);
                                        $.ajax({
                                            type: "POST",
                                            datatype: 'json',
                                            data: SMSGonderData,
                                            contentType: false,
                                            processData: false,
                                            beforeSend: function () {
                                                Swal.fire(
                                                    {
                                                        title: "Müşteriye Bilgi SMS'i Gönderiliyor!",
                                                        html: "<strong>Lütfen Bekleyin.</strong>",
                                                        onBeforeOpen: function onBeforeOpen() {
                                                            Swal.showLoading();
                                                        }
                                                    });
                                            },
                                            url: "/Otomasyon/RezervasyonIslemleri/CekimRandevuSMSGonder/",
                                            success: function (data) {
                                                if (data.Sonuc == false) {
                                                    alertify.set('notifier', 'delay', 5);
                                                    alertify.set('notifier', 'position', 'top-center');
                                                    alertify.error(data.Mesaj);
                                                    swal.close();
                                                }
                                                else if (data.Sonuc == true) {
                                                    alertify.set('notifier', 'delay', 3);
                                                    alertify.set('notifier', 'position', 'top-center');
                                                    alertify.success(data.Mesaj);
                                                    swal.close();
                                                }
                                            },
                                            error: function (err) {
                                                alert("HATA");
                                            }
                                        });
                                    }
                                });

                        }
                    },
                    error: function (err) {
                        alert("HATA");
                    }
                });


            }); // Çekim Randevusu Bilgi SMSi gönder
            // ------ Çekim Randevusu Ekleme/Silme İşlemleri

            $('input').on('focusout', function (e) {
                if ($(this).val != "") {
                    $(this).next("div.hata").remove();
                }
            }); // Validation hata kaldırma

            $('#SozlesmePersonelListesi').on('focusout', function (e) {
                if ($(this).val != "0") {
                    $("#SozlesmePersonelHata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#SozlesmePersonelListesi').on('change', function (e) {
                if ($(this).val != "0") {
                    $("#SozlesmePersonelHata").remove();
                }
            }); // zorunlu alan kontrolü

            $('#RezervasyonTurId').on('focusout', function (e) {
                if ($(this).val != "0") {
                    $("#RezervasyonTurHata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#RezervasyonTurId').on('change', function (e) {
                if ($(this).val != "0") {
                    $("#RezervasyonTurHata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#OpsiyonTarihi').on('focusout', function (e) {
                if ($(this).val != "0") {
                    $("#opsiyonhata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#ZamanDilimiId').on('focusout', function (e) {
                if ($(this).val != "0") {
                    $("#zamandilimihata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#ZamanDilimiId').on('change', function (e) {
                if ($(this).val != "0") {
                    $("#zamandilimihata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#CekimPersonelId').on('focusout', function (e) {
                if ($(this).val != "0") {
                    $("#cekimpersonelihata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#CekimPersonelId').on('change', function (e) {
                if ($(this).val != "0") {
                    $("#cekimpersonelihata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#OdemeTutar').on('focusout', function (e) {
                if ($(this).val != "0") {
                    $("#odemetutarhata").remove();
                }
            }); // zorunlu alan kontrolü
            $('#KalanOdemeTutar').on('focusout', function (e) {
                if ($(this).val != "0") {
                    $("#kalanodemetutarhata").remove();
                }
            }); // zorunlu alan kontrolü

            $("#RezervasyonBilgileriDevam").click(function () {
                // Zorunlu alanların kontrolü yapılıyor.
                var opsiyontarih = $("#OpsiyonTarihi").val().split('.');
                var rezervasyontarih = $("#RezervasyonTarihi").val().split('.');
                opsiyontarih = opsiyontarih[2] + opsiyontarih[1] + opsiyontarih[0];
                rezervasyontarih = rezervasyontarih[2] + rezervasyontarih[1] + rezervasyontarih[0];
                //if ($("#YetkiliId").val() == "0") {
                //    $("#YetkiliId").focus();
                //    $("#YetkiliIdHata").append("<div id='YetkiliHata' style='color:red'>Yetkili Seçiniz.</div>");
                //}
                //if ($("#PersonelId").val() == "0") {
                //    $("#PersonelId").focus();
                //    $("#PersonelIdHata").append("<div id='PersonelHata' style='color:red'>Personel Seçiniz.</div>");
                //}

                if ($("#RezervasyonTurId").val() == "0") {
                    $("#RezervasyonTurId").focus();
                    $("#RezervasyonTurIdHata").append("<div id='RezervasyonTurHata' style='color:red'>Rezervasyon Türünü Seçiniz.</div>");
                }
                else if (($("#RezervasyonSekliId").val() != "1") && (parseInt(opsiyontarih) >= parseInt(rezervasyontarih))) {
                    $("#OpsiyonTarihiHata").append("<div id='opsiyonhata' style='color:red'>Opsiyon Tarihi Rezervasyon Tarihinden geri bir tarih olmalıdır.</div>");
                }
                else if (($("#ZamanDilimiId").val() == "0") && ($("#BaslangicZaman").val() == $("#BitisZaman").val())) {
                    $("#BaslangicZaman").focus();
                    $("#ZamanHata").append("<div id='zamandilimihata' style='color:red'>Başlangıç ve Bitiş zamanları aynı olamaz.</div>");
                }
                else if (SozlesmePersonelIdArray.length == 0) {
                    $("#sozlesmepersonellist").append("<div id='SozlesmePersonelHata' style='color:red'>Lütfen görevli Personel(ler)i seçiniz.</div>");
                }
                else {
                    // Rezervasyon Bilgileri Sozlesme tablosuna kaydediliyor. Daha sonraki sayfalar bu kaydın güncellenmesi şeklinde devam edecek.
                    // Rezervasyon Tarihi Tatile denk Geliyor mu kontrol et
                    //var PersonelId = $("#PersonelId").find("option:selected").val();
                    //var Personel = $("#PersonelId").find("option:selected").text();
                    var PersonelData = new FormData();
                    PersonelData.append("RezervasyonTarihi", $("#RezervasyonTarihi").val());
                    PersonelData.append("PersonelIdArray", SozlesmePersonelIdArray);
                    $.ajax({
                        type: "POST",
                        datatype: 'json',
                        data: PersonelData,
                        contentType: false,
                        processData: false,
                        url: "/Otomasyon/RezervasyonIslemleri/PersonelIzinKontrol/",
                        success: function (data) {
                            if (data.Sonuc == false) {  //sonucizinkontrol = "çalışamaz";
                                var personelAdi = "";
                                $.each(data.CalisamazPersonel, function (index, pers) {
                                    personelAdi = personelAdi + pers.AdiSoyadi + "<br/>";
                                });
                                Swal.fire(
                                    {
                                        title: "Dikkat",
                                        html: "<p><h4 style='font-size:16px; color:red'> Aşağıdaki Personel(ler) rezervasyon tarihinde izinliler</h4></p> <p><h2> <strong> " + personelAdi + " </strong><h2> </p>",
                                        type: "warning",
                                        confirmButtonText: "Tamam"
                                    });
                            }
                            else if (data.Sonuc == true) {
                                //sonucizinkontrol = "çalışabilir";
                                var rezervasyontarih = $("#RezervasyonTarihi").val();
                                var TatilKontrolData = new FormData();
                                TatilKontrolData.append("RezervasyonTarihi", $("#RezervasyonTarihi").val());
                                $.ajax({
                                    type: "POST",
                                    datatype: 'json',
                                    data: TatilKontrolData,
                                    contentType: false,
                                    processData: false,
                                    url: "/Otomasyon/RezervasyonIslemleri/TatilKotrol/",
                                    success: function (data) {
                                        if (data.Sonuc == false) {
                                            Swal.fire(
                                                {
                                                    title: "Dikkat",
                                                    html: "<p><h2 style='font-size:16px; color:red'><strong>Rezervasyon Tarihi : </strong>" + rezervasyontarih + "</h2></p><h4> " + data.Mesaj + "</h4>",
                                                    type: "warning",
                                                    confirmButtonText: "Tamam"
                                                });
                                            //sonuctatilkontrol = "çalışamaz";
                                        }
                                        else if (data.Sonuc == true) {
                                            //sonuctatilkontrol = "çalışabilir";
                                            //var PersonelId = $("#PersonelId").find("option:selected").val();
                                            //var Personel = $("#PersonelId").find("option:selected").text();
                                            var ZamanDilimiId = $("#ZamanDilimiId").find("option:selected").val();
                                            var BaslangicSaati = $("#BaslangicZaman").val();
                                            var BitisSaati = $("#BitisZaman").val();
                                            var Tarih = $("#RezervasyonTarihi").val();
                                            var GorevlendirmeKontrolData = new FormData();
                                            GorevlendirmeKontrolData.append("RezervasyonTarihi", $("#RezervasyonTarihi").val());
                                            GorevlendirmeKontrolData.append("PersonelIdArray", SozlesmePersonelIdArray);
                                            GorevlendirmeKontrolData.append("ZamanDilimiId", ZamanDilimiId);
                                            GorevlendirmeKontrolData.append("BaslangicSaati", BaslangicSaati);
                                            GorevlendirmeKontrolData.append("BitisSaati", BitisSaati);
                                            $.ajax({
                                                type: "POST",
                                                datatype: 'json',
                                                data: GorevlendirmeKontrolData,
                                                contentType: false,
                                                processData: false,
                                                url: "/Otomasyon/RezervasyonIslemleri/GorevlendirmeKontrol/",
                                                success: function (data) {
                                                    if (data.Sonuc == false) {
                                                        var personelAdi = "";
                                                        $.each(data.CalisamazPersonel, function (index, pers) {
                                                            personelAdi = personelAdi + pers.AdiSoyadi + "<br/>";
                                                        });
                                                        Swal.fire(
                                                            {
                                                                title: "Dikkat",
                                                                html: "<p><h4 style='font-size:16px; color:red'> Aşağıdaki Personel(ler) rezervasyon tarihinde başka bir randevu için görevlendirilmiş.</h4></p> <p><h2> <strong> " + personelAdi + " </strong><h2> </p>",
                                                                type: "warning",
                                                                confirmButtonText: "Tamam"
                                                            });
                                                        //Swal.fire(
                                                        //{
                                                        //    title: "Dikkat",
                                                        //    html: "<p><h2 style='font-size:16px; color:red'><strong>Personel : </strong>" + Personel + "</h2></p><p><h2 style='font-size:16px; color:red'><strong>Rezervasyon Tarihi : </strong>" + Tarih + "</h2></p><h4> " + data.Mesaj + "</h4>",
                                                        //    type: "warning",
                                                        //    confirmButtonText: "Tamam"
                                                        //});
                                                        //$("#PersonelId").val("0");
                                                        //sonucgorevlendirmekontrol = "çalışamaz";
                                                    }
                                                    else if (data.Sonuc == true) {
                                                        //sonucgorevlendirmekontrol = "çalışabilir";
                                                        var SozlesmeData = new FormData();
                                                        SozlesmeData.append("SozlesmeTarihi", $("#SozlesmeTarihi").val());
                                                        SozlesmeData.append("SozlesmeNo", $("#SozlesmeNo").val());
                                                        SozlesmeData.append("Yetkili", $("#Yetkili").val());
                                                        //SozlesmeData.append("PersonelId", $("#PersonelId").val());
                                                        SozlesmeData.append("PersonelIdArray", SozlesmePersonelIdArray);
                                                        SozlesmeData.append("RezervasyonTurId", $("#RezervasyonTurId").val());
                                                        SozlesmeData.append("OrganizasyonYeri", $("#OrganizasyonYeri").val());
                                                        SozlesmeData.append("RezervasyonSekliId", $("#RezervasyonSekliId").val());
                                                        SozlesmeData.append("OpsiyonTarihi", $("#OpsiyonTarihi").val());
                                                        SozlesmeData.append("RezervasyonTarihi", $("#RezervasyonTarihi").val());
                                                        SozlesmeData.append("ZamanDilimiId", $("#ZamanDilimiId").val());
                                                        SozlesmeData.append("BaslangicZaman", $("#BaslangicZaman").val());
                                                        SozlesmeData.append("BitisZaman", $("#BitisZaman").val());

                                                        $.ajax({
                                                            type: "POST",
                                                            datatype: 'json',
                                                            data: SozlesmeData,
                                                            contentType: false,
                                                            processData: false,
                                                            url: "/Otomasyon/RezervasyonIslemleri/SozlesmeEkle/",
                                                            success: function (data) {
                                                                if (data.Sonuc == false) {
                                                                    alertify.set('notifier', 'delay', 5);
                                                                    alertify.set('notifier', 'position', 'top-center');
                                                                    alertify.error(data.Mesaj);
                                                                }
                                                                else if (data.Sonuc == true) {
                                                                    alertify.set('notifier', 'delay', 3);
                                                                    alertify.set('notifier', 'position', 'top-center');
                                                                    alertify.success(data.Mesaj);
                                                                    sozlesmeId = data.sozlesmeId;
                                                                    randevuId = data.randevuId;
                                                                    sozlesmeNo = data.sozlesmeNo;
                                                                    MusteriBilgileriAktif();
                                                                }
                                                            },
                                                            error: function (err) {
                                                                $("#YeniRezervasyonEkleModal").modal("hide");
                                                                alert("HATA");
                                                            }
                                                        });
                                                    }
                                                },
                                                error: function (err) {
                                                    $("#YeniRezervasyonEkleModal").modal("hide");
                                                    alert("HATA");
                                                }
                                            });
                                        }
                                    },
                                    error: function (err) {
                                        $("#YeniRezervasyonEkleModal").modal("hide");
                                        alert("HATA");
                                    }
                                });
                            }
                        },
                        error: function (err) {
                            $("#YeniRezervasyonEkleModal").modal("hide");
                            alert("HATA");
                        }
                    });
                }
            });
            $("#MusteriBilgileriDevam").click(function () {
                if (musteriid == 0 || musteriid == undefined) { // Müşteri seçilmemiş ise zorunlu alanlar kontrol edilecek sonra müşteri kaydı yapılacak.
                    if ($("#AdSoyad").val() == "") // Kişi seçilmişse zorunlu alan kontrolü
                    {
                        $("#AdSoyad").focus();
                        $("#AdSoyadHata").append("<div class='hata' style='color:red'>Müşteri Adını Soyadını Giriniz.</div>");
                    }
                    else if ($("#CepTel").val() == "") // Kişi seçilmişse zorunlu alan kontrolü
                    {
                        $("#CepTel").focus();
                        $("#CepTelHata").append("<div class='hata' style='color:red'>Müşterinin Cep Telefonu Numarasını Giriniz.</div>");
                    }
                    else {
                        var Musteri = new FormData();
                        Musteri.append("MusteriKodu", $("#MusteriKodu").val());
                        Musteri.append("TCKimlikNo", $("#TCKimlikNo").val());
                        Musteri.append("AdSoyad", $("#AdSoyad").val());
                        Musteri.append("CepTel", $("#CepTel").val());
                        Musteri.append("SabitTel", $("#SabitTel").val());
                        Musteri.append("Email", $("#Email").val());
                        Musteri.append("Adres", $("#Adres").val());
                        Musteri.append("Notlar", $("#Notlar").val());
                        $.ajax({
                            type: "POST",
                            datatype: 'json',
                            data: Musteri,
                            contentType: false,
                            processData: false,
                            url: "/Otomasyon/Musteriler/MusteriEkle/",
                            success: function (data) {
                                musteriid = data.MusteriId;
                                var Sozlesme = new FormData();
                                Sozlesme.append("SozlesmeId", sozlesmeId);
                                Sozlesme.append("SozlesmeNo", sozlesmeNo);
                                Sozlesme.append("MusteriId", musteriid);
                                $.ajax({
                                    type: "POST",
                                    datatype: 'json',
                                    data: Sozlesme,
                                    contentType: false,
                                    processData: false,
                                    url: "/Otomasyon/RezervasyonIslemleri/SozlesmeMusteriGuncelle/",
                                    success: function (data) {
                                        if (data.Sonuc == false) {
                                            alertify.set('notifier', 'delay', 5);
                                            alertify.set('notifier', 'position', 'top-center');
                                            alertify.error(data.Mesaj);
                                        }
                                        else if (data.Sonuc == true) {
                                            alertify.set('notifier', 'delay', 3);
                                            alertify.set('notifier', 'position', 'top-center');
                                            alertify.success(data.Mesaj);
                                            DigerBilgilerAktif();
                                        }
                                    },
                                    error: function (err) {
                                        $("#YeniRezervasyonEkleModal").modal("hide");
                                        alert("HATA");
                                    }
                                });
                            },
                            error: function (err) {
                                $("#YeniRezervasyonEkleModal").modal("hide");
                                alert("HATA");
                            }
                        });
                    }
                }
                else {
                    // varolan müşteriler içinden seçilen müşteri bilgilerinde değişiklik varsa müşteri tablosunda güncellenmeli
                    var Musteri = new FormData();
                    Musteri.append("MusteriKodu", $("#MusteriKodu").val());
                    Musteri.append("TCKimlikNo", $("#TCKimlikNo").val());
                    Musteri.append("AdSoyad", $("#AdSoyad").val());
                    Musteri.append("CepTel", $("#CepTel").val());
                    Musteri.append("SabitTel", $("#SabitTel").val());
                    Musteri.append("Email", $("#Email").val());
                    Musteri.append("Adres", $("#Adres").val());
                    Musteri.append("Notlar", $("#Notlar").val());
                    $.ajax({
                        type: "POST",
                        datatype: 'json',
                        data: Musteri,
                        contentType: false,
                        processData: false,
                        url: "/Otomasyon/Musteriler/MusteriGuncelle/" + musteriid,
                        success: function (data) {
                            if (data.Sonuc == false) {
                                alertify.set('notifier', 'delay', 5);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.error(data.Mesaj);
                            }
                            else if (data.Sonuc == true) {
                                alertify.set('notifier', 'delay', 3);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.success(data.Mesaj);
                            }
                        },
                        error: function (err) {
                            alert("HATA");
                        }
                    });

                    var Sozlesme = new FormData();
                    Sozlesme.append("SozlesmeId", sozlesmeId);
                    Sozlesme.append("SozlesmeNo", sozlesmeNo);
                    Sozlesme.append("MusteriId", musteriid);
                    $.ajax({
                        type: "POST",
                        datatype: 'json',
                        data: Sozlesme,
                        contentType: false,
                        processData: false,
                        url: "/Otomasyon/RezervasyonIslemleri/SozlesmeMusteriGuncelle/",
                        success: function (data) {
                            if (data.Sonuc == false) {
                                alertify.set('notifier', 'delay', 5);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.error(data.Mesaj);
                            }
                            else if (data.Sonuc == true) {
                                alertify.set('notifier', 'delay', 3);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.success(data.Mesaj);
                                DigerBilgilerAktif();
                            }
                        },
                        error: function (err) {
                            alert("HATA");
                        }
                    });
                }
            });
            $("#MusteriBilgileriGeri").click(function () {
                var SozlesmeData = new FormData();
                SozlesmeData.append("SozlesmeNo", sozlesmeNo);
                SozlesmeData.append("SozlesmeId", sozlesmeId);
                SozlesmeData.append("RandevuId", randevuId);
                $.ajax({
                    type: "POST",
                    datatype: 'json',
                    data: SozlesmeData,
                    contentType: false,
                    processData: false,
                    url: "/Otomasyon/RezervasyonIslemleri/SozlesmeSil/",
                    success: function (data) {
                        RezervasyonBilgileriAktif();
                    },
                    error: function (err) {
                        $("#YeniRezervasyonEkleModal").modal("hide");
                        alert("HATA");
                    }
                });
            });
            $("#DigerBilgilerDevam").click(function () {
                var mesaj = "";
                if ($("#RezervasyonTurId").find("option:selected").data("formalan") == "Gelin/Damat" && ($("#GelinAdSoyad").val() == "" || $("#GelinCep").val() == "" || $("#GelinEmail").val() == "")) {
                    mesaj = "Geline ait bilgilerde eksikler var!";
                }
                else if ($("#RezervasyonTurId").find("option:selected").data("formalan") == "Gelin/Damat" && ($("#DamatAdSoyad").val() == "" || $("#DamatCep").val() == "" || $("#DamatEmail").val() == "")) {
                    mesaj = "Damada ait bilgilerde eksikler var!";
                }
                else if ($("#RezervasyonTurId").find("option:selected").data("formalan") == "Bebek/Çocuk" && ($("#BebekAdSoyad").val() == "" || $("#BabaAdSoyad").val() == "" || $("#AnneAdSoyad").val() == "" || $("#BabaCep").val() == "" || $("#AnneCep").val() == "" || $("#BabaEmail").val() == "")) {
                    mesaj = "Bebek/Çocuk ve ailesine ait bilgilerde eksikler var!";
                }
                else if ($("#RezervasyonTurId").find("option:selected").data("formalan") == "Ürün/Katalog" && ($("#Urunler").val() == "" || $("#UrunYetkiliAdSoyad").val() || $("#UrunYetkiliCep").val() == "" || $("#UrunYetkiliEmail").val() == "")) {
                    mesaj = "Ürün/Katalog bilgilerinde eksikler var!";
                }
                else if ($("#RezervasyonTurId").find("option:selected").data("formalan") == "Model/Manken" && ($("#Modeller").val() == "" || $("#ModelYetkiliAdSoyad").val() || $("#ModelYetkiliCep").val() == "" || $("#ModelYetkiliEmail").val() == "")) {
                    mesaj = "Medellere ait bilgilerde eksikler var!";
                }
                else if ($("#RezervasyonTurId").find("option:selected").data("formalan") == "Yetkili" && ($("#YetkiliAdSoyad").val() == "" || $("#YetkiliCep").val() == "" || $("#YetkiliEmail").val() == "")) {
                    mesaj = "Yetkiliye ait bilgilerde eksikler var!";
                }
                else
                    mesaj = "";
                if (mesaj != "") {
                    Swal.fire(
                        {
                            title: "Eksik Bilgiler",
                            html: "<p style='color:red;font-weight:bold;font-size:12pt;'>" + mesaj + "</p> <p style='color:red;font-size:12pt;'><h3>Yine de devam etmek istiyor musunuz?</h3></p> ",
                            type: "warning",
                            showCancelButton: true,
                            confirmButtonText: "Evet, Devam et!",
                            cancelButtonText: "İptal"
                        }).then(function (result) {
                            if (result.value) {
                                var DegerBilgiler = new FormData();
                                DegerBilgiler.append("SozlesmeId", sozlesmeId);
                                DegerBilgiler.append("RandevuId", randevuId);
                                DegerBilgiler.append("SozlesmeNo", sozlesmeNo);
                                DegerBilgiler.append("GelinAdSoyad", $("#GelinAdSoyad").val());
                                DegerBilgiler.append("GelinCep", $("#GelinCep").val());
                                DegerBilgiler.append("GelinEmail", $("#GelinEmail").val());
                                DegerBilgiler.append("DamatAdSoyad", $("#DamatAdSoyad").val());
                                DegerBilgiler.append("DamatCep", $("#DamatCep").val());
                                DegerBilgiler.append("DamatEmail", $("#DamatEmail").val());
                                DegerBilgiler.append("BebekAdSoyad", $("#BebekAdSoyad").val());
                                DegerBilgiler.append("BabaAdSoyad", $("#BabaAdSoyad").val());
                                DegerBilgiler.append("AnneAdSoyad", $("#AnneAdSoyad").val());
                                DegerBilgiler.append("BabaCep", $("#BabaCep").val());
                                DegerBilgiler.append("AnneCep", $("#AnneCep").val());
                                DegerBilgiler.append("BabaEmail", $("#BabaEmail").val());
                                DegerBilgiler.append("Urunler", $("#Urunler").val());
                                DegerBilgiler.append("UrunYetkiliAdSoyad", $("#UrunYetkiliAdSoyad").val());
                                DegerBilgiler.append("UrunYetkiliCep", $("#UrunYetkiliCep").val());
                                DegerBilgiler.append("UrunYetkiliEmail", $("#UrunYetkiliEmail").val());
                                DegerBilgiler.append("Modeller", $("#Modeller").val());
                                DegerBilgiler.append("ModelYetkiliAdSoyad", $("#ModelYetkiliAdSoyad").val());
                                DegerBilgiler.append("ModelYetkiliCep", $("#ModelYetkiliCep").val());
                                DegerBilgiler.append("ModelYetkiliEmail", $("#ModelYetkiliEmail").val());
                                DegerBilgiler.append("YetkiliAdSoyad", $("#YetkiliAdSoyad").val());
                                DegerBilgiler.append("YetkiliCep", $("#YetkiliCep").val());
                                DegerBilgiler.append("YetkiliEmail", $("#YetkiliEmail").val());
                                $.ajax({
                                    type: "POST",
                                    datatype: 'json',
                                    data: DegerBilgiler,
                                    contentType: false,
                                    processData: false,
                                    url: "/Otomasyon/RezervasyonIslemleri/SozlesmeDigerBilgilerGuncelle/",
                                    success: function (data) {
                                        if (data.Sonuc == false) {
                                            alertify.set('notifier', 'delay', 5);
                                            alertify.set('notifier', 'position', 'top-center');
                                            alertify.error(data.Mesaj);
                                        }
                                        else if (data.Sonuc == true) {
                                            alertify.set('notifier', 'delay', 3);
                                            alertify.set('notifier', 'position', 'top-center');
                                            alertify.success(data.Mesaj);
                                            PaketVeEkhizmetlerAktif();
                                        }
                                    },
                                    error: function (err) {
                                        $("#YeniRezervasyonEkleModal").modal("hide");
                                        alert("HATA");
                                    }
                                });
                            }
                        });
                }
                else {
                    var DegerBilgiler = new FormData();
                    DegerBilgiler.append("SozlesmeId", sozlesmeId);
                    DegerBilgiler.append("RandevuId", randevuId);
                    DegerBilgiler.append("SozlesmeNo", sozlesmeNo);
                    DegerBilgiler.append("GelinAdSoyad", $("#GelinAdSoyad").val());
                    DegerBilgiler.append("GelinCep", $("#GelinCep").val());
                    DegerBilgiler.append("GelinEmail", $("#GelinEmail").val());
                    DegerBilgiler.append("DamatAdSoyad", $("#DamatAdSoyad").val());
                    DegerBilgiler.append("DamatCep", $("#DamatCep").val());
                    DegerBilgiler.append("DamatEmail", $("#DamatEmail").val());
                    DegerBilgiler.append("BebekAdSoyad", $("#BebekAdSoyad").val());
                    DegerBilgiler.append("BabaAdSoyad", $("#BabaAdSoyad").val());
                    DegerBilgiler.append("AnneAdSoyad", $("#AnneAdSoyad").val());
                    DegerBilgiler.append("BabaCep", $("#BabaCep").val());
                    DegerBilgiler.append("AnneCep", $("#AnneCep").val());
                    DegerBilgiler.append("BabaEmail", $("#BabaEmail").val());
                    DegerBilgiler.append("Urunler", $("#Urunler").val());
                    DegerBilgiler.append("UrunYetkiliAdSoyad", $("#UrunYetkiliAdSoyad").val());
                    DegerBilgiler.append("UrunYetkiliCep", $("#UrunYetkiliCep").val());
                    DegerBilgiler.append("UrunYetkiliEmail", $("#UrunYetkiliEmail").val());
                    DegerBilgiler.append("Modeller", $("#Modeller").val());
                    DegerBilgiler.append("ModelYetkiliAdSoyad", $("#ModelYetkiliAdSoyad").val());
                    DegerBilgiler.append("ModelYetkiliCep", $("#ModelYetkiliCep").val());
                    DegerBilgiler.append("ModelYetkiliEmail", $("#ModelYetkiliEmail").val());
                    DegerBilgiler.append("YetkiliAdSoyad", $("#YetkiliAdSoyad").val());
                    DegerBilgiler.append("YetkiliCep", $("#YetkiliCep").val());
                    DegerBilgiler.append("YetkiliEmail", $("#YetkiliEmail").val());
                    $.ajax({
                        type: "POST",
                        datatype: 'json',
                        data: DegerBilgiler,
                        contentType: false,
                        processData: false,
                        url: "/Otomasyon/RezervasyonIslemleri/SozlesmeDigerBilgilerGuncelle/",
                        success: function (data) {
                            if (data.Sonuc == false) {
                                alertify.set('notifier', 'delay', 5);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.error(data.Mesaj);
                            }
                            else if (data.Sonuc == true) {
                                alertify.set('notifier', 'delay', 3);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.success(data.Mesaj);
                                PaketVeEkhizmetlerAktif();
                            }
                        },
                        error: function (err) {
                            alert("HATA");
                        }
                    });
                }

            });
            $("#DigerBilgilerGeri").click(function () {
                MusteriBilgileriAktif();
            });
            $("#PaketlerDevam").click(function () {

                if (secilenpaketID.length == 0) {
                    Swal.fire(
                        {
                            title: "Paket Seçimi",
                            html: "<p><h2 style='font-size:16px; color:red'><strong>Herhangi bir paket seçmediniz! </br> Lütfen bir paket seçiniz.</strong></h2></p>",
                            type: "warning",
                            showCancelButton: false,
                            confirmButtonText: "Tamam!"
                            //cancelButtonText: "İptal"
                        })
                }
                else {
                    var PaketlerFiyat = $("#PaketTutar").val().replace(" TL", "");
                    var EkHizmetlerFiyat = $("#EkHizmetTutar").val().replace(" TL", "");
                    var Iskonto = $("#Iskonto").val().replace(" TL", "");
                    var ToplamTutar = $("#ToplamTutar").val().replace(" TL", "");
                    if (PaketlerFiyat == "") {
                        PaketlerFiyat = 0;
                    }
                    if (EkHizmetlerFiyat == "") {
                        EkHizmetlerFiyat = 0;
                    }
                    if (Iskonto == "") {
                        Iskonto = 0;
                    }
                    if (ToplamTutar == "") {
                        ToplamTutar = 0;
                    }
                    var PaketEkHizmetData = new FormData();
                    PaketEkHizmetData.append("SozlesmeId", sozlesmeId);
                    PaketEkHizmetData.append("SozlesmeNo", sozlesmeNo);
                    PaketEkHizmetData.append("secilenpaketID", secilenpaketID);
                    PaketEkHizmetData.append("secilenekhizmetID", secilenekhizmetID);
                    PaketEkHizmetData.append("PaketlerFiyat", PaketlerFiyat);
                    PaketEkHizmetData.append("EkHizmetlerFiyat", EkHizmetlerFiyat);
                    PaketEkHizmetData.append("Iskonto", Iskonto);
                    PaketEkHizmetData.append("ToplamTutar", ToplamTutar);
                    $.ajax({
                        type: "POST",
                        datatype: 'json',
                        data: PaketEkHizmetData,
                        contentType: false,
                        processData: false,
                        url: "/Otomasyon/RezervasyonIslemleri/SozlesmePaketlerEkhizmetlerGuncelle/",
                        success: function (data) {
                            if (data.Sonuc == false) {
                                alertify.set('notifier', 'delay', 5);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.error(data.Mesaj);
                            }
                            else if (data.Sonuc == true) {
                                alertify.set('notifier', 'delay', 3);
                                alertify.set('notifier', 'position', 'top-center');
                                alertify.success(data.Mesaj);
                                SureclerAktif();
                            }
                        },
                        error: function (err) {
                            $("#YeniRezervasyonEkleModal").modal("hide");
                            alert("HATA");
                        }
                    });
                }

            });
            $("#PaketlerGeri").click(function () {
                DigerBilgilerAktif();
            });
            $("#SureclerDevam").click(function () {
                var SureclerData = new FormData();
                SureclerData.append("SozlesmeId", sozlesmeId);
                SureclerData.append("SozlesmeNo", sozlesmeNo);
                SureclerData.append("secilensurecID", secilensurecID);
                $.ajax({
                    type: "POST",
                    datatype: 'json',
                    data: SureclerData,
                    contentType: false,
                    processData: false,
                    url: "/Otomasyon/RezervasyonIslemleri/SureclerGuncelle/",
                    success: function (data) {
                        if (data.Sonuc == false) {
                            alertify.set('notifier', 'delay', 5);
                            alertify.set('notifier', 'position', 'top-center');
                            alertify.error(data.Mesaj);
                        }
                        else if (data.Sonuc == true) {
                            alertify.set('notifier', 'delay', 3);
                            alertify.set('notifier', 'position', 'top-center');
                            alertify.success(data.Mesaj);
                            CekimRandevuAktif();
                        }

                    },
                    error: function (err) {
                        $("#YeniRezervasyonEkleModal").modal("hide");
                        alert("HATA");
                    }
                });
            });
            $("#SureclerGeri").click(function () {
                PaketVeEkhizmetlerAktif();
            });
            $("#CekimRandevuDevam").click(function () {
                OdemeBilgileriAktif();
            });
            $("#CekimRandevuGeri").click(function () {
                SureclerAktif();
            });
            $("#OdemelerGeri").click(function () {
                CekimRandevuAktif();
            });
            $("#OdemelerSozlesmeGoruntule").click(function () {
                //document.getElementById("SozlesmeOnizleme").src = "/Otomasyon/RezervasyonIslemleri/SozlesmeYazdir/" + sozlesmeId;
                //SozlesmeOnizlemeAktif();
                $('#KalanOdemeTarihi').datepicker(
                    {
                        todayBtn: "linked",
                        todayHighlight: true,
                        templates: controls,
                        language: 'tr',
                        autoclose: true
                    }).datepicker("setDate", new Date(new Date().setMonth(new Date().getMonth() + 1)));
                var SozlesmeKalan = $("#sozlesmekalan").html();
                SozlesmeKalan = SozlesmeKalan.replace(" TL", "");
                SozlesmeKalan = SozlesmeKalan.replace(".", "");
                SozlesmeKalan = SozlesmeKalan.replace(",", ".");

                var Tutar = accounting.formatMoney(SozlesmeKalan, "TL", 2, ".", ",", "%v %s");
                var Tarih = new Date();
                var gun = Tarih.getDate();
                if (gun < 10) {
                    gun = "0" + gun;
                }
                var ay = Tarih.getMonth() + 2;
                var yil = Tarih.getFullYear();

                if (parseFloat(SozlesmeKalan) > 0) {
                    Swal.fire(
                        {
                            title: "Kalan Ödeme",
                            html: "<p style='color:red;font-weight:bold;font-size:12pt;'> Sözleşme tutarının " + Tutar + " 'si kaldı.</p> <p style='color:red;font-size:12pt;'><h3>Bu tutarı bir ay sonrasına (" + gun + "." + ay + "." + yil + ") Gelecek Ödeme olarak eklemek istermisiz?</h3></p> ",
                            type: "warning",
                            showCancelButton: true,
                            confirmButtonText: "Evet, Devam et!",
                            cancelButtonText: "İptal"
                        }).then(function (result) {
                            if (result.value) {
                                var kalanodeme = Tutar.replace(" TL", "");
                                var AlacakData = new FormData();
                                AlacakData.append("SozlesmeId", sozlesmeId);
                                AlacakData.append("SozlesmeNo", sozlesmeNo);
                                AlacakData.append("MusteriId", musteriid);
                                AlacakData.append("KalanOdemeTarihi", $('#KalanOdemeTarihi').val());
                                //AlacakData.append("KalanOdemeTutar", $("#KalanOdemeTutar").val());
                                AlacakData.append("KalanOdemeTutar", kalanodeme);
                                AlacakData.append("KalanOdemeAciklama", $("#KalanOdemeAciklama").val());
                                $.ajax({
                                    type: "POST",
                                    datatype: 'json',
                                    data: AlacakData,
                                    contentType: false,
                                    processData: false,
                                    beforeSend: function () {
                                        Swal.fire(
                                            {
                                                title: "Sayfa Yenileniyor.!",
                                                html: "<strong>Lütfen Bekleyin.</strong>",
                                                onBeforeOpen: function onBeforeOpen() {
                                                    Swal.showLoading();
                                                }
                                            });
                                    },
                                    url: "/Otomasyon/RezervasyonIslemleri/AlacakEkle/",
                                    success: function (data) {
                                        if (data.Sonuc == false) {
                                            alertify.set('notifier', 'delay', 5);
                                            alertify.set('notifier', 'position', 'top-center');
                                            alertify.error(data.Mesaj);
                                        }
                                        else if (data.Sonuc == true) {
                                            alertify.set('notifier', 'delay', 3);
                                            alertify.set('notifier', 'position', 'top-center');
                                            alertify.success(data.Mesaj);
                                            alacaktoplam = 0; // global değişken sıfırlanıyor.
                                            var alacaktutar = 0;
                                            window.location.replace("/Otomasyon/Dashboard/Index");
                                            window.open("/Otomasyon/RezervasyonIslemleri/SozlesmeYazdir/" + sozlesmeNo, '_blank');
                                        }

                                    },
                                    error: function (err) {
                                        alert("HATA");
                                    }
                                });
                            }
                        });
                }
                else {
                    $.ajax({
                        type: "POST",
                        datatype: 'json',
                        contentType: false,
                        processData: false,
                        url: "/Otomasyon/RezervasyonIslemleri/BilgiSmsMailGonder/" + sozlesmeId,
                        success: function (data) {
                            if (data.Sonuc == true) {
                                window.location.replace("/Otomasyon/Dashboard/Index");
                                window.open("/Otomasyon/RezervasyonIslemleri/SozlesmeYazdir/" + sozlesmeNo, '_blank');
                            }
                        },
                        error: function (err) {
                            $("#YeniRezervasyonEkleModal").modal("hide");
                            alert("HATA");
                        }
                    });
                }
            });
            $("#OnizlemeGeri").click(function () {
                OdemeBilgileriAktif();
            });
            $("#SozlesmeYazdir").click(function () {
                //window.location.replace("/Otomasyon/RezervasyonIslemleri/SozlesmeYazdir2");
                window.open("/Otomasyon/RezervasyonIslemleri/SozlesmeYazdir/" + sozlesmeNo, '_blank');
            });
            $(".Vazgec").click(function () {
                Swal.fire(
                    {
                        title: "Rezervasyondan Çık",
                        html: "<p style='color:red;font-weight:bold;font-size:12pt;'>Rezervasyon işlemi iptal edilcek ve girdiğiniz tüm bilgiler silincek.</p> <p><h3>İptal etmek istiyormusnuz?</h3></p> ",

                        //html: "<p><h3>Rezervasyon işlemi iptal edilcek ve girdiğiniz tüm bilgiler silincek.</h3></p><p><h3>İptal etmek istiyormusnuz?</h3></p> ",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonText: "Devam Et!",
                        cancelButtonText: "Evet, Çık!"
                    }).then(function (result) {
                        if (result.value) {

                        }
                        else {
                            // İptal işlemi sonucu kaydedilen işlemler silincek.
                            if (sozlesmeId == 0) {
                                $("#YeniRezervasyonEkleModal").modal("hide");
                                window.location.replace("/Otomasyon/Dashboard/Index");
                                //SayfayiTemizle();
                            }
                            else {
                                var Sozlesme = new FormData();
                                Sozlesme.append("SozlesmeId", sozlesmeId);
                                $.ajax({
                                    type: "POST",
                                    datatype: 'json',
                                    data: Sozlesme,
                                    contentType: false,
                                    processData: false,
                                    url: "/Otomasyon/RezervasyonIslemleri/SozlesmeSil/",
                                    success: function (data) {
                                        $("#YeniRezervasyonEkleModal").modal("hide");
                                        //SayfayiTemizle();
                                        window.location.replace("/Otomasyon/Dashboard/Index");
                                    },
                                    error: function (err) {
                                        alert("HATA");
                                    }
                                });
                            }
                        }
                    });
            });
            $(".Kapat").click(function () {
                $("#YeniRezervasyonEkleModal").modal("hide");
            });
            //Yeni Rezervasyon ekle için ...

        });
    </script>
}





